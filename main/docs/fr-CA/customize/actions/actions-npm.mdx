---
description: Programmez les Actions de votre projet à l'aide du package NPM @auth0/actions.
'og:image': https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
'og:title': Actions NPM
'og:url': https://auth0.com/docs/
permalink: actions-npm
title: Actions NPM
'twitter:description': Programmez les Actions de votre projet à l'aide du package NPM @auth0/actions.
'twitter:title': Actions NPM
---

Le [**package NPM `@auth0/actions`**](https://www.npmjs.com/package/@auth0/actions) est la **bibliothèque officielle Actions** qui fournit les **définitions TypeScript pour Auth0 Actions**. Vous pouvez ainsi développer et tester les Actions de votre projet dans des éditeurs et IDE externes.

<div id="benefits">
  ### Avantages
</div>

Cette bibliothèque vous aide dans les cas d’utilisation suivants :

* **Assistance IDE / éditeur de code** : En s’appuyant sur cette bibliothèque, les IDE et éditeurs de code peuvent aider les développeurs qui codent grâce à la **complétion automatique**, aux **définitions d’objets et de fonctions** et à la **vérification des erreurs**.
* **Développement TypeScript** : Même si les Actions sont encore codées et exécutées avec Node.js CommonJS, cette bibliothèque permet le développement d’Actions dans des projets externes en **TypeScript**, qui peuvent ensuite être compilées et déployées en CommonJS sur le tenant Auth0.
* **Améliorations des tests unitaires** : En permettant le développement TypeScript sur des projets externes, cette bibliothèque permet aux développeurs de suivre les bonnes pratiques et **d’améliorer leurs tests unitaires** en s’appuyant sur les définitions TypeScript.
* **Génération d’Actions par l’IA** : Cette bibliothèque nous rapproche du moment où l’IA pourra générer des exemples d’Actions plus précis.

***

<div id="how-it-works">
  ### Comment ça fonctionne
</div>

<div id="installation">
  #### Installation
</div>

Utilisez l’un des gestionnaires de paquets suivants pour installer le package en tant que **dépendance de développement** :

> Le package doit être utilisé en tant que dépendance de développement pour venir compléter vos outils de développement.

* **NPM** : `npm install @auth0/actions --save-dev`
* **Yarn** : `yarn add @auth0/actions --dev`
* **Pnpm** : `pnpm add @auth0/actions --save-dev`

***

<div id="import">
  #### Importation
</div>

Voici la **structure** de la bibliothèque :

```bash
@auth0/actions
│
└───credentials-exchange
│   └───v1
│   └───v2
└───custom-email-provider
│   └───v1
└───custom-phone-provider
│   └───v1
└───custom-token-exchange
│   └───v1
└───event-stream
│   └───v1
└───password-reset-post-challenge
│   └───v1
└───post-change-password
│   └───v1
│   └───v2
└───post-login
│   └───v1
│   └───v2
│   └───v3
└───post-user-registration
│   └───v1
│   └───v2
└───pre-user-registration
│   └───v1
│   └───v2
└───send-phone-message
    └───v2
```

L&#39;instruction d&#39;importation doit être basée sur chaque **nom de déclencheur** et **numéro de version**, en tenant compte de la structure précédente de la bibliothèque.

**Respectez le modèle** : `@auth0/actions/[trigger_name]/[trigger_version]`

**Par exemple** : `@auth0/actions/post-login/v3`

Utilisez l&#39;une des options suivantes pour importer les définitions TypeScript dans vos Actions, selon votre technologie :

Utilisez cette solution lorsque vous voulez IntelliSense sans modifier la structure actuelle de votre code JavaScript :

<Tabs>
  <Tab title="JSDoc @import">
    Utilisez cette solution lorsque vous voulez IntelliSense sans modifier la structure actuelle de votre code JavaScript :

    ```javascript
    /** @import {Event, PostLoginAPI} from "@auth0/actions/post-login/v3" */

    /**
    * Gestionnaire qui sera appelé pendant l'exécution d'un flux PostLogin.
    *
    * @param {Event} event - Détails sur l'utilisateur et le contexte dans lequel il ouvre une session.
    * @param {PostLoginAPI} api - Interface dont les méthodes peuvent être utilisées pour modifier le comportement de la connexion.
    */
    exports.onExecutePostLogin = async (event, api) => {
      // Votre code
    }
    ```
  </Tab>

  <Tab title="JSDoc @param">
    Utilisez cette solution pour bénéficier de la sécurité de typage dans les fichiers JavaScript en utilisant des instructions d&#39;importation dans les commentaires JSDoc :

    ```javascript
    /**
    * Gestionnaire qui sera appelé pendant l'exécution d'un flux PostLogin.
    *
    * @param {import('@auth0/actions/post-login/v3').Event} event - Détails sur l'utilisateur et le contexte dans lequel il ouvre une session.
    * @param {import('@auth0/actions/post-login/v3').PostLoginAPI} api - Interface dont les méthodes peuvent être utilisées pour modifier le comportement de la connexion.
    */
    exports.onExecutePostLogin = async (event, api) => {
      // Votre code
    };
    ```
  </Tab>

  <Tab title="Importation TypeScript">
    Utilisez cette solution lors du développement avec TypeScript pour bénéficier d&#39;une vérification complète des types et d&#39;une syntaxe moderne :

    ```javascript
    import type { Event, PostLoginAPI } from '@auth0/actions/post-login/v3';

    /**
    * Gestionnaire qui sera appelé pendant l'exécution d'un flux PostLogin.
    *
    * @param {Event} event - Détails sur l'utilisateur et le contexte dans lequel il ouvre une session.
    * @param {PostLoginAPI} api - Interface dont les méthodes peuvent être utilisées pour modifier le comportement de la connexion.
    */
    exports.onExecutePostLogin = async (event: Event, api: PostLoginAPI) => {
      // Votre code
    };
    ```
  </Tab>
</Tabs>

<Warning>
  Lorsque vous utilisez TypeScript, vous devez compiler votre code en JavaScript avant de le déployer sur Auth0. L&#39;environnement d&#39;exécution Auth0 Actions exécute uniquement JavaScript. Utilisez le compilateur TypeScript (`tsc`) pour transpiler vos fichiers `.ts` en fichiers `.js` avant leur déploiement. Vous devez également inclure des commentaires JSDoc pour activer IntelliSense dans le tableau de bord.
</Warning>

<div id="examples">
  ### Exemples
</div>

Les exemples d’Actions suivants sont délibérément présentés à la fois en JavaScript et en TypeScript afin de permettre une comparaison directe, côte à côte.

<div id="configuration">
  #### Configuration
</div>

<Tabs>
  <Tab title="JavaScript">
    Dans votre `package.json`, définissez les dépendances de développement afin de bénéficier d’IntelliSense lorsque vous écrivez votre Action :

    ```javascript
    {
      "name": "actions-js",
      "version": "1.0.0",
      "description": "Actions JS",
      "main": "example.js",
      "author": "John Doe",
      "license": "ISC",
      "devDependencies": {
        "@auth0/actions": "^0.7.1"
      }
    }
    ```
  </Tab>

  <Tab title="TypeScript">
    Dans votre `package.json`, définissez les dépendances de développement afin de bénéficier d’IntelliSense lorsque vous écrivez votre Action.

    ```typescript
    {
      "name": "actions-ts",
      "version": "1.0.0",
      "description": "Actions TS",
      "main": "example.ts",
      "author": "John Doe",
      "license": "ISC",
      "devDependencies": {
        "@auth0/actions": "^0.7.1",
        "@types/node": "22.14.0",
        "typescript": "^5.9.2"
      }
    }
    ```

    Dans votre `tsconfig.json`, définissez les dépendances de développement afin de bénéficier d’IntelliSense lorsque vous écrivez votre Action.

    ```typescript
    {
      "compilerOptions": {
        "target": "ES2020",
        "module": "NodeNext",
        "moduleResolution": "nodenext",
        "esModuleInterop": true,
        "allowSyntheticDefaultImports": true,
        "strict": true,
        "outDir": "dist",
        "declaration": true,
        "sourceMap": true,
        "allowJs": true,
        "checkJs": false,
        "resolveJsonModule": true,
        "skipLibCheck": true,
        "forceConsistentCasingInFileNames": true,
        "isolatedModules": true
      },
      "include": [
        "**/*.ts"
      ],
      "exclude": [
        "node_modules",
        "dist"
      ]
    }
    ```
  </Tab>
</Tabs>

<div id="post-login-access-control-and-id-token-custom-claims">
  #### Contrôle d&#39;accès Post-Login et revendications personnalisées du jeton ID
</div>

L’Action d’exemple suivante s’exécuterait durant le flux Post-Login. Elle vérifie si des rôles sont attribués à l’utilisateur et appelle `api.access.deny()` si aucun n’est trouvé. Si des rôles sont présents, elle définit la revendication personnalisée dans le jeton ID.

L’instruction `import` rend des types externes disponibles pour votre code. Cela permet à l’éditeur de connaître la structure des objets `event` et `api`.

<Tabs>
  <Tab title="JavaScript">
    ```javascript
    /** @import {Event, PostLoginAPI} from "@auth0/actions/post-login/v3" */

    const CUSTOM_CLAIM_NAMESPACE = 'https://example.com';

    /**
    * Gestionnaire appelé pendant l'exécution d'un flux PostLogin.
    *
    * @param {Event} event - Détails sur l'utilisateur et le contexte dans lequel il effectue sa connexion.
    * @param {PostLoginAPI} api - Interface dont les méthodes peuvent être utilisées pour modifier le comportement de la connexion.
    */
    exports.onExecutePostLogin = async (event, api) => {
      const roles = event.authorization?.roles;

      if (roles === undefined || roles.length === 0) {
        api.access.deny('Restricted');
        return;
      }

      api.idToken.setCustomClaim(`${CUSTOM_CLAIM_NAMESPACE}/roles`, roles);
    }
    ```
  </Tab>

  <Tab title="TypeScript">
    ```typescript
    import type { Event, PostLoginAPI } from '@auth0/actions/post-login/v3';

    const CUSTOM_CLAIM_NAMESPACE = 'https://example.com';

    /**
    * Gestionnaire appelé pendant l'exécution d'un flux PostLogin.
    *
    * @param {Event} event - Détails sur l'utilisateur et le contexte dans lequel il effectue sa connexion.
    * @param {PostLoginAPI} api - Interface dont les méthodes peuvent être utilisées pour modifier le comportement de la connexion.
    */
    exports.onExecutePostLogin = async (event: Event, api: PostLoginAPI) => {
      const roles = event.authorization?.roles;

      if (roles === undefined || roles.length === 0) {
        api.access.deny('Restricted');
        return;
      }

      api.idToken.setCustomClaim(`${CUSTOM_CLAIM_NAMESPACE}/roles`, roles);
    };
    ```
  </Tab>
</Tabs>

Pour en savoir plus sur @auth0/actions, consultez : https://www.npmjs.com/package/@auth0/actions.

Pour en savoir plus sur la création d’Actions, consultez [Créez votre première Action](/docs/fr-CA/customize/actions/write-your-first-action).