---
title: "Utiliser les actions pour valider et stocker les données de l’utilisateur final recueillies par les personnalisations de l’invite d’inscription (1)"
permalink: "use-actions-to-validate-and-store-end-user-data-gathered-by-signup-prompt"
'description': "Apprenez à utiliser les actions Auth0 pour valider et stocker les données des utilisateurs finaux."
'og:title': "Utiliser les actions pour valider et stocker les données de l’utilisateur final recueillies par les personnalisations de l’invite d’inscription (1)"
'og:description': "Apprenez à utiliser les actions Auth0 pour valider et stocker les données des utilisateurs finaux."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Utiliser les actions pour valider et stocker les données de l’utilisateur final recueillies par les personnalisations de l’invite d’inscription (1)"
'twitter:description': "Apprenez à utiliser les actions Auth0 pour valider et stocker les données des utilisateurs finaux."
---

Vous pouvez utiliser la [Personnalisation de l’invite d’inscription](/docs/fr-CA/fr-ca/customize/login-pages/universal-login/customize-signup-and-login-prompts) avec le déclencheur `pre-user-registration` pour ajouter les données fournies par l’utilisateur final (comme le numéro de téléphone ou l’emplacement d’un utilisateur) de l’invite d’inscription à `user_metadata`. En option, vous pouvez valider ces données et afficher une erreur de validation dans l’invite.

<div id="prerequisites">
  ### Conditions préalables
</div>

* Le locataire a un [Domaine personnalisé](/docs/fr-CA/fr-ca/customize/custom-domains) vérifié
* Le locataire a un [Modèle de page](/docs/fr-CA/fr-ca/customize/login-pages/universal-login/customize-templates) défini

<div id="add-a-field-to-the-signup-prompt">
  ### Ajouter un champ à l’invite d’inscription
</div>

Utilisez la [Management API](https://auth0.com/docs/api/management/v2/prompts/put-custom-text-by-language) pour insérer un champ personnalisé dans une invite à l’aide de l’un des [Points d’entrée](https://auth0.com/docs/sign-up-prompt-customizations#-signup-prompt-entry-points). Cet exemple ajoute le contenu suivant au point d’insertion `ulp-container-form-content-start` :

```html lines
<div class="ulp-field">
  <label for="first-name">First Name</label>
  <input type="text" name="ulp-first-name" id="first-name">
</div>
```

Le résultat est une section First Name (Prénom) dans l’invite d’inscription :

<Frame>![](/docs/images/fr-ca/cdy7uua7fh8z/580LNGMxSkRlazJEdcVNpn/5fa98d4b414ac2133d1d6f4e327cea5a/Screenshot_2023-10-05_at_4.07.38_PM.png)</Frame>

<div id="create-an-action-in-the-pre-user-registration-trigger">
  ### Créer une action dans le déclencheur d’enregistrement préalable des utilisateurs
</div>

Vous pouvez créer une action d’inscription personnalisée en allant sur [**Actions &gt; Library (Bibliothèque) &gt; Build Custom (Créer une action personnalisée)**](https://manage.auth0.com/dashboard/us/dev-6endizjt/actions/library)**.**

<Frame>![](/docs/images/fr-ca/cdy7uua7fh8z/52VSznphe2TyoJQnAn4nQg/c4fcf640a2fac6c6c5889072342ee5a1/Create_Action_-_FR.png)</Frame>

Dans l’éditeur de code, mettez à jour le gestionnaire `onExecutePreUserRegistration` :

```js lines
exports.onExecutePreUserRegistration = async (event, api) => {
  const firstName = event.request.body['ulp-first-name'];
  api.user.setUserMetadata("firstName", firstName);
};
```

En option, vous pouvez valider l’entrée de l’utilisateur et envoyer une erreur de validation en appelant la méthode `api.validation.error`, puis déployer l’action :

```js lines
exports.onExecutePreUserRegistration = async (event, api) => {
  const firstName = event.request.body['ulp-first-name'];
  if(!firstName) {
    api.validation.error("invalid_payload", "Missing first name");
    return;
  }

  api.user.setUserMetadata("firstName", firstName);
};
```

<div id="add-the-action-to-the-flow">
  ### Ajouter l’Action au flux
</div>

Naviguez vers [**Actions &gt; Flows (Flux) &gt; Pre User Registration (Pré-enregistrement de l’utilisateur) &gt; Add Action (Ajouter une action) &gt; Custom (Personnalisée)**](https://manage.auth0.com/dashboard/us/dev-6endizjt/actions/flows/pre-user-signup/), puis faites glisser et déposez votre nouvelle action dans le flux d’enregistrement et sélectionnez **Apply (Appliquer)**.

<Frame>![](/docs/images/fr-ca/cdy7uua7fh8z/5JmjwcdZCX7pDukNa90cgD/dae853b10cf4c41d2d3543a8e167aae7/3333.png)</Frame>

<div id="test-the-action">
  ### Tester l’action
</div>

Créez un compte dans votre flux de test et laissez le champ **First Name (Prénom)** vide. Vous verrez une erreur lors de la soumission :

<Frame>![](/docs/images/fr-ca/cdy7uua7fh8z/7qIWCsP8doFWPJGvMTNXJY/1225f9b3ff7ac01a7e9b59f03ca5e139/2024-01-31_16-10-10.png)</Frame>

Après avoir saisi un nom dans le champ **First Name (Prénom)**, vous pouvez soumettre le formulaire avec succès :

<Frame>![](/docs/images/fr-ca/cdy7uua7fh8z/6TaK1VQyKGELMGmhuRIbVA/b453fe2eb97c95d92e4fbd68ce3cbd6a/2024-01-31_16-12-01.png)</Frame>

<div id="verify-that-the-data-was-saved-on-user_metadata">
  ### Vérifier que les données ont été sauvegardées sur user&#95;metadata
</div>

Naviguez vers [**User Management (Gestion des utilisateurs) &gt; Users (Utilisateurs)**](https://manage.auth0.com/dashboard/us/dev-6endizjt/users), puis confirmez que les données ont été sauvegardées en affichant l’onglet Details (Détails) :

<Frame>![](/docs/images/fr-ca/cdy7uua7fh8z/3x5lyrSJJgJQhbjsxoTmG6/a715edb34483983d0b14a21cd1561516/User_Metadata_-_French.png)</Frame>