---
title: Ajoutez l’autorisation à votre application Go
sidebarTitle: API Go

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/fr-CA/recipe.jsx";
import { LoggedInForm } from "/snippets/fr-CA/Login.jsx";
import Jwt from "/snippets/fr-CA/quickstart/backend/golang/jwt.go.mdx";
import Main from "/snippets/fr-CA/quickstart/backend/golang/main.go.mdx";

import {AuthCodeGroup} from "/snippets/fr-CA/AuthCodeGroup.jsx";

export const sections = [
  { id: "define-permissions", title: "Définir les autorisations" },
  { id: "install-dependencies", title: "Installer les dépendances" },
  { id: "configure-your-application", title: "Configurer votre application" },
  { id: "create-a-middleware-to-validate-access-tokens", title: "Créer un middleware pour valider les jetons d’accès" },
  { id: "protect-api-endpoints", title: "Protéger les points de terminaison de l’API" }
]


<Recipe isSingleColumn>
  <Content>
    Ce guide montre comment intégrer Auth0 à toute application API Go nouvelle ou existante en utilisant le paquet [go-jwt-middleware](https://github.com/auth0/go-jwt-middleware).

    Si vous n&#39;avez pas encore créé d&#39;API dans votre Auth0 Dashboard, utilisez le sélecteur interactif pour créer une nouvelle API Auth0 ou sélectionner une API existante pour votre projet.

    Pour configurer votre première API via le tableau de bord Auth0, consultez notre guide de démarrage.

    Chaque API Auth0 utilise l&#39;identifiant d&#39;API, que votre application doit utiliser pour valider le jeton d&#39;accès.

    <Info>
      **Vous débutez avec Auth0?** Découvrez le fonctionnement d’Auth0 et
      informez-vous sur la mise en œuvre de l’authentification et
      de l’autorisation d’API à l’aide du framework OAuth 2.0.
    </Info>

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Les autorisations vous permettent de définir comment les ressources peuvent être consultées au nom de l’utilisateur avec un jeton d’accès donné. Par
      exemple, vous pouvez choisir d’accorder un accès en lecture à la ressource `messages` si les utilisateurs ont le niveau d’accès de gestionnaire,
      et un accès en écriture à cette ressource s’ils ont le niveau d’accès d’administrateur.

      Vous pouvez définir les autorisations dans la vue **Permissions** de la section [APIs](https://manage.auth0.com/#/apis) de l’Auth0 Dashboard. L’exemple suivant utilise la portée `read:messages`.

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/1s3Yp5zqJiKiSWqbPSezNO/e61793a2822d095666002c3f65c71ac2/configure-permissions.png" />
      </Frame>

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      Ajoutez un fichier `go.mod` pour répertorier toutes les dépendances nécessaires.

      ```go Go lines
      // go.mod
      module 01-Authorization-RS256
      go 1.21
      require (
      github.com/auth0/go-jwt-middleware/v2 v2.2.0

      github.com/joho/godotenv v1.5.1

      )
      ```

      Installez les dépendances en exécutant la commande shell suivante :

      ```bash lines
      go mod download
      ```

      <LoggedInForm />
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Créez un fichier `.env` à la racine du répertoire de votre projet pour stocker la configuration de l’application. Ensuite,
      renseignez les variables d’environnement :

      Pour configurer cet extrait

      ```env lines
      # L'URL de notre domaine de tenant Auth0.
      Si vous utilisez un Domaine personnalisé, assurez-vous de définir cette valeur à la place.
      AUTH0_DOMAIN='{yourDomain}'
      Our Auth0 API's Identifier.
      AUTH0_AUDIENCE='{yourApiIdentifier}'
      ```

      <LoggedInForm />
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      La fonction middleware `EnsureValidToken` valide le jeton d’accès. Vous pouvez appliquer cette fonction à
      n’importe quel point de terminaison que vous souhaitez protéger. Si le jeton est valide, le point de terminaison libère les ressources. Si le jeton n’est pas
      valide, l’API retourne une erreur `401 Authorization`.

      Configurez le middleware **go-jwt-middleware** pour vérifier les jetons d’accès provenant des requêtes entrantes.

      Par défaut, votre API est configurée pour utiliser RS256 comme algorithme de signature des jetons. Comme RS256 utilise
      une paire de clés privée/publique, les jetons peuvent être vérifiés à l’aide de la clé publique de votre compte Auth0. Cette clé publique est
      accessible à l’adresse `https://{yourDomain}/.well-known/jwks.json`.

      Incluez un mécanisme pour vérifier que le jeton a une **portée** suffisante pour accéder aux ressources demandées.

      Créez une fonction `HasScope` afin de vérifier que le jeton d’accès possède la portée appropriée avant de
      retourner une réponse indiquant un succès.

      <AuthCodeGroup>
        <Jwt />

        <Main />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Dans cet exemple, créez un point de terminaison `/api/public` qui n&#39;utilise pas l&#39;intergiciel `EnsureToken`, car il est accessible aux requêtes non authentifiées.

      Créez un point de terminaison `/api/private` qui requiert l&#39;intergiciel `EnsureToken`, car il n&#39;est accessible qu&#39;aux requêtes authentifiées contenant un jeton d&#39;accès sans portée additionnelle.

      Créez un point de terminaison `/api/private-scoped` qui nécessite le middleware `EnsureToken` et
      `HasScope`, car il n&#39;est disponible que pour les requêtes authentifiées contenant un jeton d&#39;accès auquel la
      portée `read:messages` a été accordée.

      <Info>
        Seule la portée `read:messages` est vérifiée par la fonction `HasScope`. Vous pouvez envisager
        de l’étendre ou d’en faire un middleware autonome qui accepte plusieurs scopes pour l’adapter à votre cas d’utilisation.
      </Info>

      ### Effectuer un appel à votre API

      Pour effectuer des appels à votre API, vous avez besoin d&#39;un jeton d&#39;accès. Vous pouvez obtenir un jeton d&#39;accès à des fins de test dans la vue
      **Test** de vos [paramètres
      d&#39;API](https://manage.auth0.com/#/apis).

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/6jeVBuypOGX5qMRXeJn5ow/5e79037f6c852d2043789d622bdb9562/Quickstart_Example_App_-_English.png" />
      </Frame>

      Fournissez le jeton d&#39;accès comme en-tête `Authorization` dans vos requêtes.

      <AuthCodeGroup>
        ```bash cURL lines
        curl --request get \
        --url 'http:///%7ByourDomain%7D/api_path' \
        --header 'authorization: Bearer YOUR_ACCESS_TOKEN_HERE'
        ```

        ```csharp C# lines
        var client = new RestClient("http:///%7ByourDomain%7D/api_path");
        var request = new RestRequest(Method.GET);
        request.AddHeader("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE");
        IRestResponse response = client.Execute(request);
        ```

        ```go Go lines
        package main
        import (
        "fmt"
        "net/http"
        "io/ioutil"
        )
        func main() {
        url := "http:///%7ByourDomain%7D/api_path"
        req, _ := http.NewRequest("get", url, nil)
        req.Header.Add("authorization", "Bearer VOTRE_JETON_ACCES_ICI")
        res, _ := http.DefaultClient.Do(req)
        defer res.Body.Close()
        body, _ := ioutil.ReadAll(res.Body)
        fmt.Println(res)
        fmt.Println(string(body))
        }
        ```

        ```java Java lines
        HttpResponse<String> response = Unirest.get("http:///%7ByourDomain%7D/api_path")
        .header("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE")
        .asString();
        ```

        ```javascript Node.JS lines
        var axios = require("axios").default;
        var options = {
        method: 'get',
        url: 'http:///%7ByourDomain%7D/api_path',
        headers: {authorization: 'Bearer VOTRE_JETON_ACCES_ICI'}
        };
        axios.request(options).then(function (response) {
        console.log(response.data);
        }).catch(function (error) {
        console.error(error);
        });
        ```

        ```objc Obj-C lines
        #import <Foundation/Foundation.h>
        NSDictionary *headers = @{ @"authorization": @"Bearer YOUR_ACCESS_TOKEN_HERE" };
        NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http:///%7BvotreDomaine%7D/chemin_api"]
                                                          cachePolicy:NSURLRequestUseProtocolCachePolicy

                                                      timeoutInterval:10.0];

        [request setHTTPMethod:@"get"];
        [request setAllHTTPHeaderFields:headers];
        NSURLSession *session = [NSURLSession sharedSession];
        NSURLSessionDataTask *dataTask = [session dataTaskWithRequest:request
                                                completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {

                                                    if (error) {

                                                        NSLog(@&quot;%@&quot;, error);

                                                    } else {

                                                        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *) response;

                                                        NSLog(@&quot;%@&quot;, httpResponse);

                                                    }

                                                }];

        [dataTask resume];
        ```

        ```php PHP lines
        #import <Foundation/Foundation.h>
        NSDictionary *headers = @{ @"authorization": @"Bearer VOTRE_JETON_ACCES_ICI" };
        NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http:///%7ByourDomain%7D/api_path"]
                                                          cachePolicy:NSURLRequestUseProtocolCachePolicy

                                                      timeoutInterval:10.0];

        [request setHTTPMethod:@"get"];
        [request setAllHTTPHeaderFields:headers];
        NSURLSession *session = [NSURLSession sharedSession];
        NSURLSessionDataTask *dataTask = [session dataTaskWithRequest:request
                                                completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {

                                                    if (error) {

                                                        NSLog(@&quot;%@&quot;, error);

                                                    } else {

                                                        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *) response;

                                                        NSLog(@&quot;%@&quot;, httpResponse);

                                                    }

                                                }];

        [dataTask resume];
        ```

        ```python Python lines
        import http.client
        conn = http.client.HTTPConnection("")
        headers = { 'authorization': "Bearer VOTRE_JETON_ACCES_ICI" }
        conn.request("get", "/{yourDomain}/api_path", headers=headers)
        res = conn.getresponse()
        data = res.read()
        print(data.decode("utf-8"))
        ```

        ```ruby Ruby lines
        require 'uri'
        require 'net/http'
        url = URI("http:///%7ByourDomain%7D/api_path")
        http = Net::HTTP.new(url.host, url.port)
        request = Net::HTTP::Get.new(url)
        request["authorization"] = 'Bearer YOUR_ACCESS_TOKEN_HERE'
        response = http.request(request)
        puts response.read_body
        ```

        ```swift Swift lines
        import Foundation
        let headers = ["authorization": "Bearer VOTRE_JETON_ACCES_ICI"]
        let request = NSMutableURLRequest(url: NSURL(string: "http:///%7ByourDomain%7D/api_path")! as URL,
                                            cachePolicy: .useProtocolCachePolicy,

                                        timeoutInterval: 10.0)

        request.httpMethod = "get"
        request.allHTTPHeaderFields = headers
        let session = URLSession.shared
        let dataTask = session.dataTask(with: request as URLRequest, completionHandler: { (data, response, error) -> Void in
        if (error != nil) {
        print(error)

        } else {
        let httpResponse = response as? HTTPURLResponse

        print(httpResponse)

        }
        })
        dataTask.resume()
        ```
      </AuthCodeGroup>

      <Note>
        ##### Point de contrôle

        Maintenant que vous avez configuré votre application, exécutez-la et vérifiez ce qui suit :

        * `GET /api/public` est disponible pour les requêtes non authentifiées.
        * `GET /api/private` est disponible pour les requêtes authentifiées.
        * `GET /api/private-scoped` est disponible pour les requêtes authentifiées contenant un jeton d&#39;accès avec la portée `read:messages`.
      </Note>

      <AuthCodeGroup>
        <Main />

        <Jwt />
      </AuthCodeGroup>
    </Section>

    ## Prochaines étapes

    Excellent travail! Si vous vous êtes rendu jusqu&#39;ici, vous devriez maintenant avoir la connexion, la déconnexion et les informations de profil utilisateur qui fonctionnent dans votre application.

    Ce tutoriel de démarrage rapide est maintenant terminé, mais il reste encore beaucoup à découvrir. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Découvrez comment configurer et gérer votre tenant Auth0 et vos Applications
    * [Trousse de développement logiciel (SDK) go-jwt-middleware](https://github.com/auth0/go-jwt-middleware) - Explorez plus en profondeur le SDK utilisé dans ce tutoriel
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Découvrez des intégrations que vous pouvez activer pour étendre les fonctionnalités d’Auth0
  </Content>
</Recipe>