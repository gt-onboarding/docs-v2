---
title: Ajouter l’autorisation à votre application PHP
sidebarTitle: API PHP

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/fr-CA/recipe.jsx";
import { LoggedInForm } from "/snippets/fr-CA/Login.jsx";
import Index from "/snippets/fr-CA/quickstart/backend/php/index.php.mdx";
import Index2 from "/snippets/fr-CA/quickstart/backend/php/index.php2.mdx";
import Router from "/snippets/fr-CA/quickstart/backend/php/router.php.mdx";
import Router2 from "/snippets/fr-CA/quickstart/backend/php/router.php2.mdx";
import Router3 from "/snippets/fr-CA/quickstart/backend/php/router.php3.mdx";

import {AuthCodeGroup} from "/snippets/fr-CA/AuthCodeGroup.jsx";

export const sections = [
      { id: "configure-auth0", title: "Configurer Auth0" },
      { id: "install-the-auth0-php-sdk", title: "Installer la trousse de développement logiciel (SDK) Auth0 pour PHP" },
      { id: "listen-for-the-bearer-tokens", title: "Surveiller les jetons Bearer" },
      { id: "create-and-configure-routes", title: "Créer et configurer les routes" },
      { id: "configure-endpoint-authorization", title: "Configurer l’autorisation du point de terminaison" },
      { id: "authorize-with-scopes", title: "Autoriser à l’aide de scopes" }
]


<Recipe isSingleColumn>
  <Content>
    Auth0 vous permet d&#39;ajouter rapidement une autorisation de point de terminaison basée sur des jetons à presque n&#39;importe quel type d&#39;application. Ce guide
    explique comment intégrer Auth0, ajouter une autorisation basée sur des jetons et protéger les routes d&#39;application à l&#39;aide de la
    Trousse de développement logiciel (SDK) PHP Auth0.

    Pour utiliser ce démarrage rapide, vous devez :

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Pour utiliser les services Auth0, vous devez avoir une application enregistrée dans l&#39;Auth0 Dashboard. L&#39;application Auth0
      est l&#39;endroit où vous configurez le fonctionnement de l&#39;authentification pour votre projet.

      ### Configurer une application

      Utilisez le sélecteur interactif pour créer une nouvelle application Auth0 ou sélectionner une application existante qui représente
      le projet que vous voulez intégrer. Chaque application dans Auth0 se voit attribuer un ID client alphanumérique unique que
      le code de votre application utilise pour appeler les API Auth0 au moyen de la Trousse de développement logiciel (SDK).

      Tous les paramètres que vous configurez à l&#39;aide de ce démarrage rapide sont automatiquement mis à jour pour votre application dans le [Dashboard](https://manage.auth0.com/#/), où vous
      pourrez gérer vos applications à l&#39;avenir.

      Si vous préférez explorer une configuration complète, vous pouvez plutôt consulter une application d&#39;exemple.

      ### Configurer une API

      De la même façon, vous devez créer une nouvelle API Auth0 ou utiliser une API existante qui représente le projet que vous
      intégrez depuis le [Dashboard](https://manage.auth0.com/#/). Choisissez un identifiant unique pour l&#39;API et prenez-en note. Vous aurez besoin
      de cet identifiant pour configurer votre application ci-dessous.

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      Auth0 fournit une [trousse de développement logiciel (SDK) PHP](https://github.com/auth0/auth0-PHP) (Auth0-PHP) pour simplifier la mise en œuvre de l’authentification et de l’autorisation Auth0 dans les applications PHP.

      La trousse de développement logiciel (SDK) Auth0 pour PHP nécessite l’installation de [PSR-17](https://www.php-fig.org/psr/psr-17/) et de [PSR-18](https://www.php-fig.org/psr/psr-18/), qui sont des bibliothèques HTTP compatibles permettant de gérer les requêtes réseau. Si vous n’avez pas déjà de bibliothèques installées, vous pouvez opter pour des options fiables en exécutant les commandes suivantes dans votre terminal :

      ```bash lines
      cd <your-project-directory>
      composer require symfony/http-client nyholm/psr7
      ```

      Installez maintenant la trousse de développement logiciel (SDK) Auth0 pour PHP en exécutant la commande suivante dans le terminal :

      ```bash lines
      composer require auth0/auth0-php
      ```

      ### Configurer la trousse de développement logiciel (SDK) Auth0

      Pour que la trousse de développement logiciel (SDK) Auth0 fonctionne correctement, vous devez définir les propriétés suivantes dans le SDK Auth0 lors de l’initialisation :

      * `strategy`: La stratégie permet d’orienter le comportement du SDK en fonction du cas d’utilisation de votre application. Dans ce
        cas, définissez-la sur la constante

        `Auth0\SDK\Configuration\SdkConfiguration::STRATEGY_API`
      * domain: Le domaine de votre tenant Auth0. En général, vous le trouverez dans Auth0 Dashboard, sous les
        paramètres de l’Application, dans le champ Domain. Si vous utilisez un domaine personnalisé, définissez cette propriété sur la valeur de votre domaine personnalisé
        à la place.
      * clientId: L’ID de l’Application Auth0 que vous avez configurée plus tôt dans ce démarrage rapide. Vous pouvez le trouver dans
        Auth0 Dashboard sous les paramètres de votre Application, dans le champ Client ID.
      * clientSecret: Le secret de l’Application Auth0 que vous avez créée plus tôt dans ce démarrage rapide. Le Client Secret se trouve dans
        Auth0 Dashboard sous les paramètres de votre Application, dans le champ Client Secret.
      * audience: L’identifiant de l’API Auth0 que vous avez enregistrée ci-dessus. Cette valeur doit être fournie sous forme de tableau.

      <Note>
        ##### Point de contrôle

        Votre SDK Auth0 est maintenant correctement configuré. Exécutez votre application pour vérifier que :

        * Le SDK s’initialise correctement.
        * Votre Application ne génère pas d’erreurs liées à Auth0.
      </Note>

      <AuthCodeGroup>
        <Index />

        <Router />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Ensuite, étendez votre application pour récupérer et traiter les jetons Bearer. Les jetons Bearer sont des jetons d’accès fournis à
      votre API avec les requêtes des clients au nom des utilisateurs. Les jetons d’accès approuvent ou refusent l’accès aux routes de votre
      application. On parle alors d’autorisation d’endpoint.

      La façon la plus simple d’obtenir des jetons d’accès à partir d’une requête est d’utiliser la méthode `getBearerToken()`
      de la Trousse de développement logiciel (SDK) PHP. Cette méthode récupère les jetons à partir des paramètres GET, du corps POST, des en-têtes de requête et d’autres sources. Dans ce
      cas, le SDK PHP traite les jetons transmis par les requêtes GET dans le paramètre `token` ou par l’en-tête HTTP
      `Authorization`.

      <AuthCodeGroup>
        <Index2 />

        <Router />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      Installez maintenant une bibliothèque de routage pour aider à diriger les requêtes entrantes vers votre application. Ce n&#39;est pas une étape obligatoire, mais elle simplifie la structure de l&#39;application dans le cadre de ce Démarrage rapide.

      ```bash lines
      composer require steampixel/simple-php-router
      ```

      Créez un nouveau fichier dans votre application nommé `router.php` pour définir les routes. Copiez le code depuis le panneau interactif à droite sous l’onglet **router.php**.

      <AuthCodeGroup>
        <Router />

        <Index />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Maintenant que vous avez configuré votre application Auth0, le SDK PHP Auth0 et que votre application récupère les jetons Bearer
      à partir des requêtes, la prochaine étape consiste à configurer l’autorisation des points de terminaison pour votre projet. La
      méthode `getBearerToken()` que vous avez implémentée ci-dessus retourne une instance de la classe `Token` qui inclut
      des détails sur l’accès de la requête.

      Étant donné que la méthode `getBearerToken()` valide et vérifie automatiquement la requête entrante, votre
      application détermine les détails du jeton d’accès en évaluant la réponse de la méthode. Lorsque la réponse est
      null, aucun jeton valide n’a été fourni. Sinon, inspectez le contenu de la réponse pour en savoir plus sur la
      requête.

      Dans le panneau interactif à droite, vous pouvez voir une vérification permettant de déterminer si la réponse est null ou non afin de filtrer l’accès à
      votre route `/api/private`.

      <AuthCodeGroup>
        <Router2 />

        <Index />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      Dans certains cas, vous pouvez souhaiter filtrer l’accès à une route spécifique en fonction des scopes demandés dans un jeton d’accès. Comme le montre le panneau interactif à droite, évaluez le contenu de la propriété &#39;scope&#39; dans la réponse de la méthode `getBearerToken()` pour vérifier les scopes accordés par le jeton d’accès.

      <AuthCodeGroup>
        <Router3 />

        <Index />
      </AuthCodeGroup>
    </Section>

    ## Prochaines étapes

    Excellent travail! Si vous vous êtes rendu jusqu&#39;ici, vous devriez maintenant avoir la connexion, la déconnexion et les informations de profil utilisateur qui fonctionnent dans votre application.

    Ce tutoriel de démarrage rapide est maintenant terminé, mais il reste encore beaucoup à découvrir. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Apprenez à configurer et à gérer votre tenant Auth0 et vos applications Auth0
    * [Auth0-PHP SDK](https://github.com/auth0/auth0-php) - Explorez plus en détail la trousse de développement logiciel (SDK) Auth0-PHP utilisée dans ce tutoriel
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Découvrez les intégrations que vous pouvez activer afin d’étendre les fonctionnalités d’Auth0
  </Content>
</Recipe>