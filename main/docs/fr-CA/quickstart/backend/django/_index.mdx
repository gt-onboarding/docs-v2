---
title: Ajouter l'autorisation à votre application API Django
sidebarTitle: API Django

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/fr-CA/recipe.jsx";
import { LoggedInForm } from "/snippets/fr-CA/Login.jsx";
import Validator from "/snippets/fr-CA/quickstart/backend/django/validator.py.mdx";
import Views from "/snippets/fr-CA/quickstart/backend/django/views.py.mdx";
import Urls from "/snippets/fr-CA/quickstart/backend/django/urls.py.mdx";

import {AuthCodeGroup} from "/snippets/fr-CA/AuthCodeGroup.jsx";

export const sections = [
  { id: "define-permissions", title: "Définir les autorisations" },
  { id: "configure-django-to-use-auth0", title: "Configurer Django pour utiliser Auth0" },
  { id: "create-the-jwt-validator", title: "Créer le validateur JWT" },
  { id: "create-the-api-views", title: "Créer les vues de l'API" },
  { id: "add-url-mappings", title: "Ajouter les correspondances d'URL" }
]


<Recipe isSingleColumn>
  <Content>
    Ce guide explique comment intégrer Auth0 à toute API Python nouvelle ou existante construite avec [Django](https://www.djangoproject.com/).

    Si vous n&#39;avez pas encore créé d&#39;API dans votre Auth0 Dashboard, vous pouvez utiliser le sélecteur interactif pour créer une nouvelle API Auth0 ou sélectionner une API existante qui représente le projet que vous souhaitez intégrer.

    Vous pouvez également consulter notre guide de démarrage,
    qui vous aidera à configurer votre première API dans le Auth0 Dashboard.

    Chaque API dans Auth0 est configurée à l&#39;aide d&#39;un identifiant d&#39;API que le code de votre application utilisera comme audience pour valider le jeton d&#39;accès.

    <Info>
      **Nouveau sur Auth0 ?** Découvrez le fonctionnement d’Auth0 et
      informez-vous sur la mise en œuvre de l’authentification et de
      l’autorisation d’API à l’aide du cadre OAuth 2.0.
    </Info>

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Les permissions vous permettent de définir comment les ressources peuvent être consultées au nom de l’utilisateur à l’aide d’un jeton d’accès donné. Par exemple, vous pouvez choisir d’accorder un accès en lecture à la ressource `messages` si les utilisateurs ont le niveau d’accès de gestionnaire, et d’accorder un accès en écriture à cette ressource s’ils ont le niveau d’accès d’administrateur.

      Vous pouvez définir les permissions autorisées dans la vue **Permissions** de la section [APIs](https://manage.auth0.com/#/apis) de l’Auth0 Dashboard. L’exemple suivant utilise la portée `read:messages`.

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/1s3Yp5zqJiKiSWqbPSezNO/e61793a2822d095666002c3f65c71ac2/configure-permissions.png" />
      </Frame>

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      ### Installer les dépendances

      1. Ajoutez les dépendances suivantes à votre `requirements.txt` :
      2. Exécutez `pip install -r requirements.txt`

      ### Créer une application Django

      <LoggedInForm />
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Vous utiliserez une bibliothèque appelée [Authlib](https://github.com/lepture/authlib) pour créer un [ResourceProtector](https://docs.authlib.org/en/latest/flask/1/resource-server.html), qui est un type de [décorateur de vue Django](https://docs.djangoproject.com/en/4.0/topics/http/decorators/) protégeant vos ressources (vues d’API) à l’aide d’un validateur donné.

      Le validateur vérifiera le jeton d’accès que vous transmettez à la ressource en s’assurant qu’il possède une signature et des revendications (claims) valides.

      Vous pouvez utiliser le validateur `JWTBearerTokenValidator` d’Authlib avec quelques ajustements pour vous assurer qu’il est conforme à nos exigences de [validation des jetons d’accès](https://auth0.com/docs/secure/tokens/access-tokens/validate-access-tokens).

      Pour créer votre `Auth0JWTBearerTokenValidator`, vous devez lui passer votre `domain` et votre `audience` (identificateur d’API). Il obtiendra ensuite la clé publique requise pour vérifier la signature du jeton et la transmettra à la classe `JWTBearerTokenValidator`.

      Vous remplacerez ensuite la propriété `claims_options` de la classe pour vous assurer que les revendications (claims) `expiry`, `audience` et `issue` du jeton sont validées conformément à nos exigences.

      Créez le fichier `apiexample/validator.py` en utilisant le code provenant du panneau interactif.

      <AuthCodeGroup>
        <Views />

        <Validator />

        <Urls />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      Ensuite, vous allez créer trois vues d’API dans `apiexample/views.py` :

      * `/api/public` : un point de terminaison public qui ne nécessite aucune authentification.
      * `/api/private` : un point de terminaison privé qui nécessite un jeton d’accès JWT valide.
      * `/api/private-scoped` : un point de terminaison privé qui nécessite un jeton d’accès JWT valide contenant la
        portée indiquée (`scope`).

      Les routes protégées auront un décorateur `require_auth`, qui est un `ResourceProtector`
      utilisant le `Auth0JWTBearerTokenValidator` que vous avez créé précédemment.

      Pour créer le `Auth0JWTBearerTokenValidator`, vous allez lui transmettre le domaine de votre tenant et l’identificateur de l’API que vous avez créée précédemment.

      Le décorateur `require_auth` sur la route `private_scoped` accepte un argument supplémentaire
      `"read:messages"`, qui vérifie que le jeton d’accès contient la permission (portée) que vous avez créée précédemment.

      <AuthCodeGroup>
        <Validator />

        <Views />

        <Urls />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Dans les étapes précédentes, vous avez ajouté des méthodes au fichier `views.py`. Ensuite, associez ces méthodes à des URL en utilisant le [répartiteur d&#39;URL](https://docs.djangoproject.com/en/4.0/topics/http/urls/) de Django, qui vous permet d&#39;associer des modèles d&#39;URL à des vues.

      Ajoutez les patterns d&#39;URL à votre fichier `apiexample/urls.py`.

      ### Effectuer un appel à votre API

      Pour effectuer des appels à votre API, vous aurez besoin d&#39;un jeton d&#39;accès. Vous pouvez obtenir un jeton d&#39;accès à des fins de test à partir de la vue **Test** dans vos [paramètres d&#39;API](https://manage.auth0.com/#/apis).

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/6jeVBuypOGX5qMRXeJn5ow/5e79037f6c852d2043789d622bdb9562/Quickstart_Example_App_-_English.png" />
      </Frame>

      Fournissez le jeton d&#39;accès comme en-tête `Authorization` dans vos requêtes.

      <AuthCodeGroup>
        ```bash cURL lines
        curl --request get \
        --url 'http:///%7ByourDomain%7D.com/api_path' \
        --header 'authorization: Bearer YOUR_ACCESS_TOKEN_HERE'
        ```

        ```csharp C# lines
        var client = new RestClient("http:///%7ByourDomain%7D.com/api_path");
        var request = new RestRequest(Method.GET);
        request.AddHeader("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE");
        IRestResponse response = client.Execute(request);
        ```

        ```go Go lines
        package main
        import (
        "fmt"
        "net/http"
        "io/ioutil"
        )
        func main() {
        url := "http:///%7ByourDomain%7D.com/api_path"
        req, _ := http.NewRequest("get", url, nil)
        req.Header.Add("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE")
        res, _ := http.DefaultClient.Do(req)
        defer res.Body.Close()
        body, _ := ioutil.ReadAll(res.Body)
        fmt.Println(res)
        fmt.Println(string(body))
        }
        ```

        ```java Java lines
        HttpResponse<String> response = Unirest.get("http:///%7ByourDomain%7D.com/api_path")
        .header("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE")
        .asString();
        ```

        ```javascript Node.JS lines
        var axios = require("axios").default;
        var options = {
        method: 'get',
        url: 'http:///%7ByourDomain%7D.com/api_path',
        headers: {authorization: 'Bearer YOUR_ACCESS_TOKEN_HERE'}
        };
        axios.request(options).then(function (response) {
        console.log(response.data);
        }).catch(function (error) {
        console.error(error);
        });
        ```

        ```objc Obj-C lines
        #import <Foundation/Foundation.h>
        NSDictionary *headers = @{ @"authorization": @"Bearer YOUR_ACCESS_TOKEN_HERE" };
        NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http:///%7ByourDomain%7D.com/api_path"]
                                                          cachePolicy:NSURLRequestUseProtocolCachePolicy

                                                      timeoutInterval:10.0];

        [request setHTTPMethod:@"get"];
        [request setAllHTTPHeaderFields:headers];
        NSURLSession *session = [NSURLSession sharedSession];
        NSURLSessionDataTask *dataTask = [session dataTaskWithRequest:request
                                                completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {

                                                    if (error) {

                                                        NSLog(@&quot;%@&quot;, error);

                                                    } else {

                                                        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *) response;

                                                        NSLog(@&quot;%@&quot;, httpResponse);

                                                    }

                                                }];

        [dataTask resume];
        ```

        ```php PHP lines
        $curl = curl_init();
        curl_setopt_array($curl, [
        CURLOPT_URL => "http:///%7ByourDomain%7D.com/api_path",
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_ENCODING => "",
        CURLOPT_MAXREDIRS => 10,
        CURLOPT_TIMEOUT => 30,
        CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
        CURLOPT_CUSTOMREQUEST => "get",
        CURLOPT_HTTPHEADER => [
        &quot;authorization: Bearer YOUR_ACCESS_TOKEN_HERE&quot;

        ],
        ]);
        $response = curl_exec($curl);
        $err = curl_error($curl);
        curl_close($curl);
        if ($err) {
        echo "Erreur cURL nº : " . $err;
        } else {
        echo $response;
        }
        ```

        ```python Python lines
        import http.client
        conn = http.client.HTTPConnection("")
        headers = { 'authorization': "Bearer YOUR_ACCESS_TOKEN_HERE" }
        conn.request("get", "/{yourDomain}.com/api_path", headers=headers)
        res = conn.getresponse()
        data = res.read()
        print(data.decode("utf-8"))
        ```

        ```ruby Ruby lines
        require 'uri'
        require 'net/http'
        url = URI("http:///%7ByourDomain%7D.com/api_path")
        http = Net::HTTP.new(url.host, url.port)
        request = Net::HTTP::Get.new(url)
        request["authorization"] = 'Bearer YOUR_ACCESS_TOKEN_HERE'
        response = http.request(request)
        puts response.read_body
        ```

        ```swift Swift lines
        import Foundation
        let headers = ["authorization": "Bearer YOUR_ACCESS_TOKEN_HERE"]
        let request = NSMutableURLRequest(url: NSURL(string: "http:///%7ByourDomain%7D.com/api_path")! as URL,
                                            cachePolicy: .useProtocolCachePolicy,

                                        timeoutInterval: 10.0)

        request.httpMethod = "get"
        request.allHTTPHeaderFields = headers
        let session = URLSession.shared
        let dataTask = session.dataTask(with: request as URLRequest, completionHandler: { (data, response, error) -> Void in
        if (error != nil) {
        print(error)

        } else {
        let httpResponse = response as? HTTPURLResponse

        print(httpResponse)

        }
        })
        dataTask.resume()
        ```
      </AuthCodeGroup>

      <AuthCodeGroup>
        <Urls />

        <Validator />

        <Views />
      </AuthCodeGroup>
    </Section>

    ## Prochaines étapes

    Excellent travail! Si vous vous êtes rendu jusqu&#39;ici, vous devriez maintenant avoir la connexion, la déconnexion et les informations de profil utilisateur qui fonctionnent dans votre application.

    Ce tutoriel de démarrage rapide est maintenant terminé, mais il reste encore beaucoup à découvrir. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Découvrez comment configurer et gérer votre tenant Auth0 et vos Applications Auth0
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Découvrez les intégrations que vous pouvez utiliser pour étendre les fonctionnalités d’Auth0
  </Content>
</Recipe>