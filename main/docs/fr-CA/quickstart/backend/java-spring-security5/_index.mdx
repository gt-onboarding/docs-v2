---
title: Ajouter l’autorisation à votre application Spring Boot
sidebarTitle: API Spring Boot

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/fr-CA/recipe.jsx";
import { LoggedInForm } from "/snippets/fr-CA/Login.jsx";
import Application from "/snippets/fr-CA/quickstart/backend/java-spring-security5/application.yml.mdx";
import Securityconfig from "/snippets/fr-CA/quickstart/backend/java-spring-security5/SecurityConfig.java.mdx";
import Apicontroller from "/snippets/fr-CA/quickstart/backend/java-spring-security5/APIController.java.mdx";

import {AuthCodeGroup} from "/snippets/fr-CA/AuthCodeGroup.jsx";

export const sections = [
  { id: "define-permissions", title: "Définir les autorisations" },
  { id: "configure-the-sample-project", title: "Configurer le projet d’exemple" },
  { id: "install-dependencies", title: "Installer les dépendances" },
  { id: "configure-the-resource-server", title: "Configurer le serveur de ressources" },
  { id: "create-the-domain-object", title: "Créer l’objet de domaine" },
  { id: "create-the-api-controller", title: "Créer le contrôleur d’API" },
  { id: "run-the-application", title: "Exécuter l’application" }
]


<Recipe isSingleColumn>
  <Content>
    Auth0 vous permet d&#39;ajouter rapidement l&#39;autorisation à votre application. Ce guide explique comment intégrer Auth0 à n&#39;importe quelle application Spring Boot, nouvelle ou existante.

    Si vous n&#39;avez pas encore créé d&#39;API dans votre Auth0 Dashboard, utilisez le sélecteur interactif pour créer une nouvelle API Auth0
    ou sélectionnez une API existante qui représente le projet que vous souhaitez intégrer.

    Consultez [notre guide de démarrage](https://auth0.com/docs/get-started/auth0-overview/set-up-apis) pour configurer votre première API à l&#39;aide du Auth0 Dashboard.

    Chaque API Auth0 utilise l&#39;identifiant d&#39;API, que votre application doit utiliser pour valider le jeton d&#39;accès.

    <Info>
      **Vous débutez avec Auth0?** Découvrez [comment fonctionne Auth0](https://auth0.com/docs/overview)
      et comment [mettre en œuvre l’authentification et l’autorisation d’API](https://auth0.com/docs/api-auth) à l’aide du cadre OAuth 2.0.
    </Info>

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Les autorisations vous permettent de définir comment les ressources peuvent être consultées ou modifiées au nom de l’utilisateur au moyen d’un jeton d’accès donné. Par exemple, vous pourriez choisir d’accorder un accès en lecture à la ressource `messages` si les utilisateurs ont le niveau d’accès gestionnaire, et un accès en écriture à cette ressource s’ils ont le niveau d’accès administrateur.

      Vous pouvez définir les autorisations permises dans la vue **Permissions** de la section [APIs](https://manage.auth0.com/dashboard/us/dev-1-2s2aq0/apis) d’Auth0 Dashboard.

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/1s3Yp5zqJiKiSWqbPSezNO/e61793a2822d095666002c3f65c71ac2/configure-permissions.png" />
      </Frame>

      <Info>
        Cet exemple utilise la portée `read:messages`.
      </Info>

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      Le projet d’exemple utilise un fichier `/src/main/resources/application.yml`, qui le configure pour utiliser le
      **domaine** Auth0 et l’**identifiant d’API** corrects pour votre API. Si vous téléchargez le code à partir de cette page, il
      sera configuré automatiquement. Si vous clonez l’exemple à partir de GitHub, vous devrez le remplir vous‑même.

      <AuthCodeGroup>
        <Application />

        <Securityconfig />

        <Apicontroller />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Si vous utilisez Gradle, vous pouvez ajouter les dépendances requises à l’aide du [Spring Boot Gradle Plugin](https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/html/) et du [Dependency Management Plugin](https://docs.spring.io/dependency-management-plugin/docs/current/reference/html/) pour gérer les versions des dépendances :

      ```gradle lines
      // build.gradle
      plugins {

          id 'java'

          id 'org.springframework.boot'

          version '3.1.5'

          id 'io.spring.dependency-management'

          version '1.1.3'

      }

      dependencies {

          implementation 'org.springframework.boot:spring-boot-starter-web'

          implementation 'com.okta.spring:okta-spring-boot-starter:3.0.5'

      }
      ```

      Si vous utilisez Maven, ajoutez les dépendances Spring à votre fichier `pom.xml` :

      ```xml lines
      // pom.xml
      <parent>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-parent</artifactId>
      <version>3.1.5</version>
      <relativePath/>
      </parent>
      <dependencies>
      <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-web</artifactId>
      </dependency>
      <dependency>
      <groupId>com.okta.spring</groupId>
      <artifactId>okta-spring-boot-starter</artifactId>
      <version>3.0.5</version>
      </dependency>
      </dependencies>
      ```

      <AuthCodeGroup>
        <Application />

        <Securityconfig />

        <Apicontroller />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      Pour configurer l&#39;application en tant que serveur de ressources et valider les JWT, créez une classe qui fournira une
      instance de `SecurityFilterChain` et ajoutez l&#39;annotation `@Configuration`.

      ### Protéger les points de terminaison de l&#39;API

      Les routes ci-dessous sont disponibles pour les requêtes suivantes :

      * `GET /api/public` : disponible pour les requêtes non authentifiées
      * `GET /api/private` : disponible pour les requêtes authentifiées contenant un jeton d’accès sans
        scopes supplémentaires
      * `GET /api/private-scoped` : disponible pour les requêtes authentifiées contenant un jeton d’accès avec
        la portée `read:messages` accordée

      L&#39;exemple ci-dessous montre comment sécuriser les méthodes de l&#39;API en utilisant l&#39;objet `HttpSecurity` fourni dans la
      méthode `filterChain()` de la classe `SecurityConfig`. Les route matchers restreignent l&#39;accès en fonction
      du niveau d&#39;autorisation requis.

      <Info>
        Par défaut, Spring Security crée un `GrantedAuthority` pour chaque portée dans la
        revendication `scope` du JWT. Cette portée permet d&#39;utiliser la méthode
        `hasAuthority("SCOPE_read:messages")` pour restreindre l&#39;accès à un JWT valide qui contient
        la portée `read:messages`.
      </Info>

      <AuthCodeGroup>
        <Securityconfig />

        <Application />

        <Apicontroller />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Pour que votre endpoint renvoie un JSON, vous pouvez utiliser un `record` Java. Les variables membres de cet objet sont sérialisées
      en paires clé-valeur dans votre JSON. Créez un nouveau `record` nommé `Message` comme exemple d&#39;objet de domaine à
      renvoyer lors des appels à l&#39;API.

      <AuthCodeGroup>
        <Application />

        <Securityconfig />

        <Apicontroller />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      Créez une nouvelle classe nommée `APIController` pour traiter les requêtes vers les points de terminaison de l’API. La classe
      `APIController` définit trois routes, comme indiqué dans la section [Protect API Endpoints](https://auth0.com/docs/quickstart/backend/java-spring-security5/interactive#configure-the-resource-server). Pour cet exemple, autorisez toutes les origines au moyen de l’annotation
      `@CrossOrigin`. Les applications en production devraient configurer `CORS` selon leur cas d’utilisation.

      <AuthCodeGroup>
        <Apicontroller />

        <Securityconfig />

        <Application />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7" isSingleColumn>
      Pour générer et exécuter le projet d&#39;exemple, exécutez la tâche Gradle `bootRun`.

      Linux ou macOS :

      ```sh lines
      ./gradlew bootRun
      ```

      Windows :

      ```sh lines
      gradlew.bat bootRun
      ```

      Si vous configurez votre propre application à l&#39;aide de Maven et du [Spring Boot Maven Plugin](https://docs.spring.io/spring-boot/docs/current/reference/html/build-tool-plugins-maven-plugin.html), vous pouvez exécuter l&#39;objectif
      `spring-boot:run`.

      Linux ou macOS :

      ```sh lines
      mvn spring-boot:run
      ```

      Windows :

      ```sh lines
      mvn.cmd spring-boot:run
      ```

      <Note>
        ##### Point de contrôle

        L&#39;application d&#39;exemple sera disponible à l&#39;adresse `http://localhost:3010/`. Pour savoir comment tester
        et utiliser votre API, consultez l&#39;article [Utiliser votre API](https://auth0.com/docs/quickstart/backend/java-spring-security5/02-using).
      </Note>

      <LoggedInForm />
    </Section>
  </Content>
</Recipe>