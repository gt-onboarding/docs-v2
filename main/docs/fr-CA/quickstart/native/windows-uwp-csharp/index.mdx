---
title: "UWP"
permalink: "01-login"
---

import {AuthCodeBlock} from "/snippets/fr-CA/AuthCodeBlock.jsx";

<div id="by-damien-guard">
  ##### Par Damien Guard
</div>

Ce tutoriel montre comment ajouter une fonctionnalité de connexion utilisateur à une application UWP C# à l’aide d’Auth0. Nous vous recommandons de vous connecter afin de suivre ce Démarrage rapide avec des exemples configurés pour votre compte.

{/* <Card title="Afficher sur GitHub" href="https://github.com/auth0-samples/auth0-uwp-oidc-samples/tree/master/Quickstart/00-Starter-Seed" icon="github">
  Configuration système requise : Microsoft Visual Studio 2017 | Windows 10 SDK (10.0.10586.0) | Auth0.OidcClient.UWP 2.3.1
  </Card> */}

<Info>
  **Vous débutez en matière d’authentification?** Découvrez [comment Auth0 fonctionne](/docs/fr-CA/get-started/auth0-overview), comment il [s’intègre aux applications natives](/docs/fr-CA/get-started/architecture-scenarios/mobile-api) et quel [protocole](/docs/fr-CA/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce) il utilise.
</Info>

<div id="configure-auth0">
  ## Configurer Auth0
</div>

<div id="get-your-application-keys">
  ### Obtenir les clés de votre Application
</div>

Lorsque vous vous êtes inscrit à Auth0, une nouvelle Application a été créée pour vous, ou vous avez peut-être créé une nouvelle Application. Vous aurez besoin de certains détails concernant cette Application pour communiquer avec Auth0. Vous pouvez obtenir ces informations dans la section [Application Settings](https://manage.auth0.com/#/applications) d’Auth0 Dashboard.

<Frame>![Tableau de bord de l'application](https://cdn2.auth0.com/docs/1.14550.0/media/articles/dashboard/client_settings.png)</Frame>

<Info>
  Lorsque vous utilisez l’Application par défaut (Default App) avec une application native ou une application monopage (SPA), assurez-vous de définir **Token Endpoint Authentication Method** sur `None` et de définir **Application Type** sur `SPA` ou `Native`.
</Info>

Vous aurez besoin des informations suivantes :

* **Domaine**
* **ID client**

<Info>
  Si vous téléchargez l’exemple en haut de cette page, ces détails sont déjà renseignés pour vous.
</Info>

<div id="configure-callback-urls">
  ### Configurer les URL de redirection
</div>

Une URL de redirection est une URL dans votre application vers laquelle Auth0 redirige l’utilisateur après son authentification. L’URL de redirection pour votre application doit être ajoutée au champ **URL de redirection autorisées** dans vos [paramètres d’Application](https://manage.auth0.com/#/applications). Si ce champ n’est pas configuré, les utilisateurs ne pourront pas ouvrir une session dans l’application et recevront une erreur.

<Info>
  Si vous suivez le projet d’exemple que vous avez téléchargé en haut de cette page, vous devriez définir les **URL de redirection autorisées** sur `https://{yourDomain}/mobile`.
</Info>

<div id="configure-logout-urls">
  ### Configurer les URL de déconnexion
</div>

Une URL de déconnexion est une URL de votre application vers laquelle Auth0 peut rediriger l’utilisateur après qu’il a été déconnecté du Serveur d’autorisation. Cette URL est spécifiée dans le paramètre de requête `returnTo`. L’URL de déconnexion de votre application doit être ajoutée au champ **URL de déconnexion autorisées** dans vos [paramètres d’Application](https://manage.auth0.com/#/applications). Si ce champ n’est pas défini, les utilisateurs ne pourront pas se déconnecter de l’application et obtiendront une erreur.

<Info>
  Si vous suivez le projet d’exemple que vous avez téléchargé en haut de cette page, l’URL de déconnexion que vous devez ajouter au champ **URL de déconnexion autorisées** est `https://{yourDomain}/mobile`.
</Info>

<div id="integrate-auth0-in-your-application">
  ## Intégrer Auth0 à votre application
</div>

<div id="install-dependencies">
  ### Installer les dépendances
</div>

Utilisez la console du gestionnaire de packages NuGet (Tools -&gt; NuGet Package Manager -&gt; Package Manager Console) pour installer le package `Auth0.OidcClient.UWP` en exécutant la commande suivante :

```
Install-Package Auth0.OidcClient.UWP
```

<div id="trigger-authentication">
  ## Déclencher l’authentification
</div>

Pour intégrer la connexion Auth0 à votre application, il vous suffit d’instancier un objet de la classe `Auth0Client` en configurant le Domaine Auth0 et l’ID client :

export const codeExample = `// MainPage.xaml.cs

using Auth0.OidcClient;

var client = new Auth0Client(new Auth0ClientOptions
{
    Domain = "{yourDomain}",
    ClientId = "{yourClientId}"
});`;

<AuthCodeBlock children={codeExample} language="cs" />

Vous pouvez ensuite appeler la méthode `LoginAsync` pour connecter l’utilisateur :

```cs lines
var loginResult = await client.LoginAsync();
```

<Frame>![](https://cdn2.auth0.com/docs/1.14550.0/media/articles/native-platforms/windows-uwp-csharp/universal-login.png)</Frame>

Cela va charger la page de connexion Auth0 dans une vue Web. Pour savoir comment personnaliser cette page, consultez [ce document](/docs/fr-CA/authenticate/login/auth0-universal-login#simple-customization).

<div id="handle-authentication-tokens">
  ## Gérer les jetons d’authentification
</div>

Le résultat de la connexion renvoyé indiquera si l’authentification a réussi et, le cas échéant, contiendra les jetons et les déclarations (claims) de l’utilisateur.

<div id="authentication-error">
  ### Erreur d’authentification
</div>

Vous pouvez vérifier la propriété `IsError` du résultat afin de déterminer si la connexion a échoué. La propriété `ErrorMessage` contient des informations plus détaillées sur l’erreur survenue.

```cs lines
if (loginResult.IsError)
{
    Debug.WriteLine($"Une erreur s'est produite lors de la connexion : {loginResult.Error}")
}
```

<div id="accessing-the-tokens">
  ### Accès aux jetons
</div>

Après une connexion réussie, le résultat de la connexion contiendra un jeton d&#39;identité et un jeton d&#39;accès dans les propriétés `IdentityToken` et `AccessToken`, respectivement.

```cs lines
if (!loginResult.IsError)
{
    Debug.WriteLine($"id_token: {loginResult.IdentityToken}");
    Debug.WriteLine($"access_token: {loginResult.AccessToken}");
}
```

<div id="obtaining-the-user-information">
  ### Obtention des renseignements sur l’utilisateur
</div>

En cas de connexion réussie, le résultat de la connexion contiendra les renseignements sur l’utilisateur dans la propriété `User`, qui est un [ClaimsPrincipal](https://msdn.microsoft.com/en-us/library/system.security.claims.claimsprincipal\(v=vs.110\).aspx).

Pour obtenir des renseignements sur l’utilisateur, vous pouvez interroger les claims. Par exemple, vous pouvez obtenir le nom et l’adresse de courriel de l’utilisateur à partir des claims `name` et `email` :

```cs lines
if (!loginResult.IsError)
{
    Debug.WriteLine($"name: {loginResult.User.FindFirst(c => c.Type == "name")?.Value}");
    Debug.WriteLine($"email: {loginResult.User.FindFirst(c => c.Type == "email")?.Value}");
}
```

<Info>
  Les revendications exactes renvoyées dépendront des scopes demandés. Pour plus d&#39;informations, consultez @scopes.
</Info>

Vous pouvez obtenir une liste de toutes les revendications que contient le jeton ID en parcourant la collection `Claims` :

```cs lines
if (!loginResult.IsError)
{
    foreach (var claim in loginResult.User.Claims)
    {
        Debug.WriteLine($"{claim.Type} = {claim.Value}");
    }
}
```

<div id="logout">
  ## Déconnexion
</div>

Pour déconnecter l&#39;utilisateur, appelez la méthode `LogoutAsync`.

```cs lines
await client.LogoutAsync();
```

<Info>
  ##### Que pouvez-vous faire ensuite ?

  <table>
    <tr>
      <td><a href="/docs/fr-CA/authenticate/identity-providers">Configurer d&#39;autres fournisseurs d&#39;identité</a></td>
      <td><a href="/docs/fr-CA/secure/multi-factor-authentication">Activer l&#39;authentification multifacteur</a></td>
    </tr>

    <tr>
      <td><a href="/docs/fr-CA/secure/attack-protection">En savoir plus sur la protection contre les attaques</a></td>
      <td><a href="/docs/fr-CA/customize/rules">En savoir plus sur les Rules</a></td>
    </tr>
  </table>

  [Modifier sur GitHub](https://github.com/auth0/docs/edit/master/articles/quickstart/backend/aspnet-core-webapi/01-authorization.md)
</Info>

***
