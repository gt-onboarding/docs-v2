---
title: "WPF / Winforms"
permalink: "01-login"
---

import {AuthCodeBlock} from "/snippets/fr-CA/AuthCodeBlock.jsx";

<div id="by-damien-guard">
  ##### Par Damien Guard
</div>

Ce tutoriel explique comment ajouter la fonctionnalité de connexion des utilisateurs à une application C# WPF et Windows Forms à l’aide d’Auth0. Nous vous recommandons de vous connecter afin de suivre ce Démarrage rapide avec des exemples adaptés à votre compte.

{/* <Card title="Afficher sur GitHub" href="https://github.com/auth0-samples/auth0-WinFormsWPF-oidc-samples/tree/master/Quickstart/00-Starter-Seed" icon="github">
  Configuration requise : Microsoft Visual Studio 2022 | .NET Framework 4.6.2 | .NET 6
  </Card> */}

<Info>
  **Vous débutez avec Auth0?** Découvrez [le fonctionnement d’Auth0](/docs/fr-CA/get-started/auth0-overview), comment il [s’intègre aux applications natives](/docs/fr-CA/get-started/architecture-scenarios/mobile-api) et [le protocole](/docs/fr-CA/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce) qu’il utilise.
</Info>

<div id="configure-auth0">
  ## Configurer Auth0
</div>

<div id="get-your-application-keys">
  ### Obtenir vos clés d’application
</div>

Lorsque vous vous êtes inscrit à Auth0, une nouvelle application a été créée pour vous, ou vous avez peut-être choisi d’en créer une nouvelle. Vous aurez besoin de certains détails concernant cette application pour communiquer avec Auth0. Vous pouvez obtenir ces détails dans la section [Application Settings](https://manage.auth0.com/#/applications) de l’Auth0 Dashboard.

<Frame>![Tableau de bord de l’application](https://cdn2.auth0.com/docs/1.14550.0/media/articles/dashboard/client_settings.png)</Frame>

<Info>
  Lorsque vous utilisez l’application par défaut avec une application native ou une application monopage, assurez-vous de définir **Token Endpoint Authentication Method** sur `None` et de définir **Application Type** sur `SPA` ou `Native`.
</Info>

Vous avez besoin des informations suivantes :

* **Domaine**
* **ID client**

<Info>
  Si vous téléchargez l’exemple à partir du haut de cette page, ces détails sont déjà renseignés pour vous.
</Info>

<div id="configure-callback-urls">
  ### Configurer les URL de redirection (callback)
</div>

Une URL de redirection (callback) est une URL de votre application vers laquelle Auth0 redirige l’utilisateur après son authentification. L’URL de redirection de votre application doit être ajoutée au champ **URL de redirection autorisées (Allowed Callback URLs)** dans vos [Application Settings](https://manage.auth0.com/#/applications). Si ce champ n’est pas défini, les utilisateurs ne pourront pas se connecter à l’application et verront un message d’erreur.

<Info>
  Si vous suivez le projet d’exemple que vous avez téléchargé en haut de cette page, vous devez définir le champ **URL de redirection autorisées (Allowed Callback URLs)** sur `https://{yourDomain}/mobile`.
</Info>

<div id="configure-logout-urls">
  ### Configurer les URL de déconnexion
</div>

Une URL de déconnexion est une URL dans votre application vers laquelle Auth0 peut rediriger après que l’utilisateur a été déconnecté du Serveur d’autorisation. Elle est spécifiée dans le paramètre de requête `returnTo`. L’URL de déconnexion de votre application doit être ajoutée au champ **URL de déconnexion autorisées** dans vos [Application Settings](https://manage.auth0.com/#/applications). Si ce champ n’est pas défini, les utilisateurs ne pourront pas se déconnecter de l’application et recevront une erreur.

<Info>
  Si vous suivez le projet d’exemple que vous avez téléchargé en haut de cette page, l’URL de déconnexion que vous devez ajouter au champ **URL de déconnexion autorisées** est `https://{yourDomain}/mobile`.
</Info>

<div id="integrate-auth0-in-your-application">
  ## Intégrer Auth0 à votre application
</div>

<div id="install-dependencies">
  ### Installer les dépendances
</div>

Les packages NuGet `Auth0.OidcClient.WPF` ou `Auth0.OidcClient.WinForms` vous permettent d’authentifier des utilisateurs auprès de tout [fournisseur d&#39;identité pris en charge par Auth0](/docs/fr-CA/authenticate/identity-providers).

Utilisez le gestionnaire de packages NuGet (Outils -&gt; Gestionnaire de package de la bibliothèque -&gt; Console du gestionnaire de package) pour installer le package `Auth0.OidcClient.WPF` ou `Auth0.OidcClient.WinForms`, selon que vous créez une application WPF ou Windows Forms :

<div id="trigger-authentication">
  ## Déclencher l’authentification
</div>

Pour intégrer la connexion Auth0 à votre application, il suffit d’instancier la classe `Auth0Client` en lui passant votre Domaine Auth0 et votre ID client dans le constructeur.

export const codeExample = `// Form1.cs

using Auth0.OidcClient;

Auth0ClientOptions clientOptions = new Auth0ClientOptions
{
    Domain = "{yourDomain}",
    ClientId = "{yourClientId}"
};
client = new Auth0Client(clientOptions);
clientOptions.PostLogoutRedirectUri = clientOptions.RedirectUri;`;

<AuthCodeBlock children={codeExample} language="cs" />

Vous pouvez ensuite appeler la méthode `LoginAsync` pour effectuer la connexion de l’utilisateur :

```cs lines
var loginResult = await client.LoginAsync();
```

<Frame>![](https://cdn2.auth0.com/docs/1.14550.0/media/articles/native-platforms/wpf-winforms/universal-login.png)</Frame>

Cela charge la page de connexion Auth0 dans une vue Web. Pour savoir comment personnaliser la page de connexion, consultez [ce document](/docs/fr-CA/authenticate/login/auth0-universal-login#simple-customization).

<div id="handle-authentication-tokens">
  ## Gérer les jetons d’authentification
</div>

Le résultat de connexion retourné indiquera si l’authentification a réussi et, le cas échéant, contiendra les jetons et les revendications (claims) de l’utilisateur.

<div id="authentication-error">
  ### Erreur d’authentification
</div>

Vous pouvez vérifier la propriété `IsError` du résultat pour déterminer si la connexion a échoué. La propriété `ErrorMessage` fournira plus de renseignements sur l’erreur survenue.

```cs lines
var loginResult = await client.LoginAsync();

if (loginResult.IsError)
{
    Debug.WriteLine($"Une erreur s'est produite lors de la connexion : {loginResult.Error}");
}
```

<div id="accessing-the-tokens">
  ### Accéder aux jetons
</div>

Après une connexion réussie, le résultat de la connexion contiendra le jeton ID et le jeton d’accès dans les propriétés `IdentityToken` et `AccessToken`, respectivement.

```cs lines
var loginResult = await client.LoginAsync();

if (!loginResult.IsError)
{
    Debug.WriteLine($"id_token: {loginResult.IdentityToken}");
    Debug.WriteLine($"access_token: {loginResult.AccessToken}");
}
```

<div id="obtaining-the-user-information">
  ### Obtention des informations sur l’utilisateur
</div>

Lors d’une connexion réussie, le résultat de la connexion contiendra les informations sur l’utilisateur dans la propriété `User`, qui est un [ClaimsPrincipal](https://msdn.microsoft.com/en-us/library/system.security.claims.claimsprincipal\(v=vs.110\).aspx).

Pour obtenir des informations sur l’utilisateur, vous pouvez interroger les revendications. Vous pouvez, par exemple, obtenir le nom et l’adresse de courriel de l’utilisateur à partir des revendications `name` et `email` :

```cs lines
if (!loginResult.IsError)
{
    Debug.WriteLine($"name: {loginResult.User.FindFirst(c => c.Type == "name")?.Value}");
    Debug.WriteLine($"email: {loginResult.User.FindFirst(c => c.Type == "email")?.Value}");
}
```

<Info>
  Les revendications exactes renvoyées dépendront des scopes qui ont été demandés. Pour plus d&#39;informations, voir @scopes.
</Info>

Vous pouvez obtenir la liste de toutes les revendications contenues dans le jeton ID en parcourant la collection `Claims` :

```cs lines
if (!loginResult.IsError)
{
    foreach (var claim in loginResult.User.Claims)
    {
        Debug.WriteLine($"{claim.Type} = {claim.Value}");
    }
}
```

<div id="logout">
  ## Déconnexion
</div>

Pour déconnecter l’utilisateur, appelez la méthode `LogoutAsync`.

```cs lines
await client.LogoutAsync();
```

<Info>
  ##### Que pouvez-vous faire ensuite ?

  <table>
    <tr>
      <td><a href="/docs/fr-CA/authenticate/identity-providers">Configurer d&#39;autres fournisseurs d&#39;identité</a></td>
      <td><a href="/docs/fr-CA/secure/multi-factor-authentication">Activer l&#39;authentification multifacteur</a></td>
    </tr>

    <tr>
      <td><a href="/docs/fr-CA/secure/attack-protection">En savoir plus sur la protection contre les attaques</a></td>
      <td><a href="/docs/fr-CA/customize/rules">En savoir plus sur Rules</a></td>
    </tr>
  </table>

  [Modifier sur GitHub](https://github.com/auth0/docs/edit/master/articles/quickstart/backend/aspnet-core-webapi/01-authorization.md)
</Info>

***
