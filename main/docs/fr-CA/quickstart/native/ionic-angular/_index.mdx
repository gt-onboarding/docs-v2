---
title: Ajoutez une fonctionnalité de connexion à votre application Ionic Angular avec Capacitor
sidebarTitle: Ionic et Capacitor (Angular)

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/fr-CA/recipe.jsx";
import { LoggedInForm } from "/snippets/fr-CA/Login.jsx";
import AppModule from "/snippets/fr-CA/quickstart/native/ionic-angular/app.module.ts.mdx";
import AppComponent from "/snippets/fr-CA/quickstart/native/ionic-angular/app.component.ts.mdx";
import Loginbutton from "/snippets/fr-CA/quickstart/native/ionic-angular/login-button.ts.mdx";
import Logoutbutton from "/snippets/fr-CA/quickstart/native/ionic-angular/logout-button.ts.mdx";
import Userprofile from "/snippets/fr-CA/quickstart/native/ionic-angular/user-profile.ts.mdx";

import {AuthCodeGroup} from "/snippets/fr-CA/AuthCodeGroup.jsx";

export const sections = [
  { id: "getting-started", title: "Mise en route" },
  { id: "configure-auth0", title: "Configurer Auth0" },
  { id: "install-the-auth0-angular-sdk", title: "Installer la trousse de développement logiciel (SDK) Auth0 pour Angular" },
  { id: "register-and-configure-the-authentication-module", title: "Enregistrer et configurer le module d'authentification" },
  { id: "add-login-to-your-application", title: "Ajouter une connexion à votre application" },
  { id: "handling-the-login-callback", title: "Gérer le callback de connexion" },
  { id: "add-logout-to-your-application", title: "Ajouter une déconnexion à votre application" },
  { id: "show-the-user-profile", title: "Afficher le profil de l'utilisateur" }
]

<Recipe isSingleColumn>
  <Content>
    Auth0 vous permet d&#39;ajouter rapidement l&#39;authentification et d&#39;accéder aux informations de profil d&#39;utilisateur dans votre application. Ce guide
    explique comment intégrer Auth0 avec une application Ionic (Angular) et Capacitor en utilisant le [SDK Auth0 Angular](https://github.com/auth0/auth0-angular).

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Ce démarrage rapide part du principe que vous avez déjà une application [Ionic](https://ionicframework.com/) en place et fonctionnant avec [Capacitor](https://capacitorjs.com/). Sinon, consultez le guide [Using Capacitor with Ionic Framework](https://capacitorjs.com/docs/getting-started/with-ionic) pour démarrer avec une application simple, ou clonez [nos applications d’exemple](https://github.com/auth0-samples/auth0-ionic-samples).

      Il est également recommandé de vous familiariser avec le [flux de développement de Capacitor](https://capacitorjs.com/docs/basics/workflow).

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      Pour utiliser les services Auth0, vous devez avoir une application configurée dans Auth0 Dashboard. C’est dans l’application Auth0
      que vous configurerez le fonctionnement de l’authentification pour votre projet.

      <Info>
        Dans tout cet article, `YOUR_PACKAGE_ID` correspond à l’ID de package de votre application. Vous pouvez le
        trouver et le configurer dans le champ `appId` de votre fichier `capacitor.config.ts`. Consultez
        [le schéma de configuration de Capacitor](https://capacitorjs.com/docs/config#schema) pour plus d’informations.
      </Info>

      ### Configurer une application

      Utilisez le sélecteur interactif pour créer une nouvelle application Auth0 ou sélectionner une application existante qui représente
      le projet que vous voulez intégrer. Chaque application dans Auth0 reçoit un ID client alphanumérique unique
      que le code de votre application utilisera pour appeler les API Auth0 au moyen de la trousse de développement logiciel (SDK).

      Tous les paramètres que vous configurez à l’aide de ce démarrage rapide seront automatiquement mis à jour pour votre application dans le [Dashboard](https://manage.auth0.com/#/), où vous pourrez
      gérer vos applications par la suite.

      Si vous préférez examiner une configuration complète, vous pouvez plutôt consulter une application d’exemple.

      ### Configurer les URL de rappel (Callback)

      Une URL de rappel (callback) est une URL dans votre application vers laquelle vous voulez qu’Auth0 redirige les utilisateurs après qu’ils se sont
      authentifiés. Si elle n’est pas définie, les utilisateurs ne seront pas renvoyés à votre application après leur connexion.

      <Info>
        Si vous suivez notre projet d’exemple, définissez cette valeur comme suit :

        `YOUR_PACKAGE_ID://{yourDomain}/capacitor/YOUR_PACKAGE_ID/callback`
      </Info>

      ### Configurer les URL de déconnexion

      Une URL de déconnexion est une URL dans votre application vers laquelle vous voulez qu’Auth0 redirige les utilisateurs après leur
      déconnexion. Si elle n’est pas définie, les utilisateurs ne pourront pas se déconnecter depuis votre application et recevront une erreur.

      <Info>
        Si vous suivez notre projet d’exemple, définissez cette valeur comme suit :

        `YOUR_PACKAGE_ID://{yourDomain}/capacitor/YOUR_PACKAGE_ID/callback`
      </Info>

      ### Configurer les origines autorisées (Allowed Origins)

      Pour pouvoir envoyer des requêtes de votre application native vers Auth0, configurez les **origines autorisées (Allowed Origins)** suivantes dans
      vos [paramètres d’Application](https://manage.auth0.com/#/applications/\{yourClientId}/settings).

      <Info>
        Si vous suivez notre projet d’exemple, définissez cette valeur sur
        `capacitor://localhost, http://localhost`, respectivement pour iOS et Android.
      </Info>

      Enfin, assurez-vous que le **Type d’Application** de votre application est défini sur **Native** dans les [paramètres d’Application](https://manage.auth0.com/#/applications/\{yourClientId}/settings).

      <LoggedInForm />
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Exécutez la commande suivante dans le répertoire de votre projet pour installer la trousse de développement logiciel (SDK) Auth0 pour Angular :

      ```bash
      npm install @auth0/auth0-angular
      ```

      La trousse de développement logiciel (SDK) expose plusieurs types qui vous aident à intégrer Auth0 de manière idiomatique à votre application Angular, notamment un module et un service d’authentification.

      ### Installer les plugins Capacitor

      Ce démarrage rapide et l’exemple utilisent certains des plugins officiels de Capacitor. Installez-les dans votre application à l’aide de la commande suivante :

      ```bash
      npm install @capacitor/browser @capacitor/app
      ```

      * [@capacitor/browser](https://capacitorjs.com/docs/apis/browser): Vous permet d’interagir avec le navigateur
        système de l’appareil et sert à ouvrir l’URL du point de terminaison d’autorisation d’Auth0.
      * [@capacitor/app](https://capacitorjs.com/docs/apis/app): Vous permet de vous abonner à des événements globaux de l’application,
        ce qui est utile pour traiter les rappels (callbacks) provenant d’Auth0.

      <Info>
        Le plugiciel Browser de Capacitor sur iOS utilise [SFSafariViewController](https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller) qui, sur iOS 11 et versions ultérieures, ne partage pas
        les témoins (cookies) avec Safari sur l’appareil. Cela signifie que le SSO ne fonctionnera pas sur ces appareils. Si vous avez besoin du
        SSO, utilisez plutôt un plugiciel compatible qui repose sur [ASWebAuthenticationSession](https://developer.apple.com/documentation/authenticationservices/aswebauthenticationsession).
      </Info>

      <LoggedInForm />
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      La trousse de développement logiciel (SDK) exporte `AuthModule`, un module qui contient tous les services requis pour que le SDK
      fonctionne. Ce module doit être enregistré auprès de votre application et être configuré avec votre domaine Auth0 et
      votre ID client.

      La fonction `AuthModule.forRoot` prend la configuration suivante :

      * `domain` : La valeur `domain` présente sous **Settings** de l&#39;application que vous
        avez créée dans l&#39;Auth0 Dashboard, ou votre domaine personnalisé si vous utilisez la fonctionnalité de domaines personnalisés d&#39;Auth0.
      * `clientId` : La valeur Client ID présente sous **Settings** de l&#39;application que vous avez créée
        dans l&#39;Auth0 Dashboard.
      * `useRefreshTokens` : Pour utiliser auth0-angular avec Ionic sur Android et iOS, il est nécessaire d&#39;activer
        les jetons d&#39;actualisation.
      * `useRefreshTokensFallback` : Pour utiliser auth0-angular avec Ionic sur Android et iOS, il est nécessaire de
        désactiver le mécanisme de repli basé sur un iframe.
      * `authorizationParams.redirect_uri` : L&#39;URL vers laquelle rediriger vos utilisateurs après leur authentification auprès
        d&#39;Auth0.

      <Info>
        Pour conserver l&#39;authentification après la fermeture et la réouverture de l&#39;application, vous pouvez définir
        `cacheLocation` sur `localstorage` lors de la configuration du SDK, mais veuillez prendre connaissance
        [des risques liés au stockage
        des jetons dans localstorage](/docs/fr-CA/libraries/auth0-single-page-app-sdk#change-storage-options). De plus, localstorage doit être traité comme **transitoire** dans une application Capacitor, car les données pourraient être récupérées de façon inattendue dans certaines circonstances. Veuillez lire les [recommandations sur le stockage dans la documentation de Capacitor](https://capacitorjs.com/docs/guides/storage#why-cant-i-just-use-localstorage-or-indexeddb).

        En outre, le SDK peut [utiliser une implémentation de cache personnalisée](https://github.com/auth0/auth0-spa-js/blob/master/EXAMPLES.md#creating-a-custom-cache) pour stocker les jetons, si
        vous devez utiliser un mécanisme de stockage plus sécurisé et plus persistant.

        **Remarque** : nous déconseillons d&#39;utiliser le [plugiciel Storage de Capacitor](https://capacitorjs.com/docs/apis/storage) pour stocker les jetons, car celui-ci
        repose sur [UserDefaults](https://developer.apple.com/documentation/foundation/userdefaults) et [SharedPreferences](https://developer.android.com/reference/android/content/SharedPreferences) sur iOS et Android respectivement. Les données stockées à l&#39;aide
        de ces API ne sont pas chiffrées, ne sont pas sécurisées et peuvent également être synchronisées dans le nuage.
      </Info>

      <Note>
        ##### Point de contrôle

        Maintenant que vous avez configuré votre application avec le SDK Auth0 Angular, exécutez votre application pour vérifier que le
        SDK s&#39;initialise sans erreur et que votre application fonctionne comme auparavant.
      </Note>

      <AuthCodeGroup>
        <AppModule />

        <AppComponent />

        <Loginbutton />

        <Logoutbutton />

        <Userprofile />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Dans une application Capacitor, le [plugiciel Browser de Capacitor](https://capacitorjs.com/docs/apis/browser) effectue une redirection vers la [page Universal Login](https://auth0.com/universal-login) d’Auth0. Configurez le paramètre `openUrl`
      de la fonction `loginWithRedirect` pour utiliser `Browser.open`, afin que l’URL soit
      ouverte à l’aide du composant de navigateur système de l’appareil ([SFSafariViewController](https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller) sur iOS et [Chrome
      Custom Tabs](https://developer.chrome.com/docs/android/custom-tabs) sur Android).

      <Info>
        Par défaut, la méthode `loginWithRedirect` du SDK utilise `window.location.href` pour
        naviguer vers la page de connexion dans le navigateur par défaut de l’appareil de l’utilisateur plutôt que dans le
        composant de navigateur système approprié à la plateforme. L’utilisateur quitterait votre application pour
        s’authentifier, ce qui pourrait nuire à l’expérience utilisateur.
      </Info>

      <Note>
        ##### Point de contrôle

        La fonction `loginWithRedirect` indique au SDK d’initier le flux de connexion, en utilisant la
        fonction `Browser.open` pour ouvrir l’URL de connexion avec le composant de navigateur système de la
        plateforme en configurant le paramètre `openUrl`. Cela permet à vos utilisateurs de se connecter à votre
        application. Les utilisateurs sont redirigés vers la page de connexion sur Auth0 et ne reçoivent aucune erreur.
      </Note>

      <AuthCodeGroup>
        <Loginbutton />

        <AppModule />

        <AppComponent />

        <Logoutbutton />

        <Userprofile />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      Une fois que les utilisateurs se sont connectés avec la page Universal Login, ils sont redirigés vers votre application au moyen d’une URL utilisant un schéma d’URL personnalisé. L’événement `appUrlOpen` doit être géré dans votre application. Vous pouvez appeler la méthode `handleRedirectCallback` à partir de la Trousse de développement logiciel (SDK) Auth0 pour initialiser l’état d’authentification.

      Vous pouvez uniquement utiliser cette méthode lors d’une redirection provenant d’Auth0. Pour vérifier que tout s’est bien passé, assurez-vous de la présence des paramètres `code` et `state` dans l’URL.

      La méthode `Browser.close()` doit fermer le navigateur lorsque cet événement est déclenché.

      Notez que la fonction de rappel de l’événement `appUrlOpen` est encapsulée dans `ngZone.run`. Les changements aux observables qui se produisent lorsque `handleRedirectCallback` s’exécute sont pris en compte par l’application Angular. Pour en savoir plus, lisez [Using
      Angular with Capacitor](https://capacitorjs.com/docs/guides/angular). Sinon, l’écran ne se met pas à jour pour afficher l’état authentifié après la connexion.

      <Info>
        Cet article suppose que vous utiliserez des schémas d’URL personnalisés (Custom URL Schemes) pour gérer le callback dans votre
        application. Pour ce faire, enregistrez votre `YOUR_PACKAGE_ID` comme schéma d’URL pour la plateforme de votre choix.
        Pour en savoir plus, lisez [Defining a Custom URL Scheme](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) pour iOS, ou [Create Deep Links to App Content](https://developer.android.com/training/app-links/deep-linking) pour Android.
      </Info>

      <Note>
        ##### Point de contrôle

        Ajoutez `appUrlOpen` au composant `App` de votre application et connectez-vous. La fenêtre du navigateur
        devrait se fermer une fois que l’utilisateur est authentifié et connecté à votre application.
      </Note>

      <AuthCodeGroup>
        <AppComponent />

        <AppModule />

        <Loginbutton />

        <Logoutbutton />

        <Userprofile />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7" isSingleColumn>
      Maintenant que les utilisateurs peuvent se connecter, vous devez configurer un moyen de les déconnecter.
      Les utilisateurs doivent être redirigés vers le point de terminaison de déconnexion Auth0 dans le navigateur
      pour effacer leur session de navigation. Encore une fois, le plugin Browser de Capacitor doit effectuer cette
      redirection afin que l’utilisateur ne quitte pas votre application et ne vive pas une expérience sous‑optimale.

      Pour y parvenir avec Ionic et Capacitor en conjonction avec la Trousse de développement logiciel (SDK) Auth0 :

      * Créez l’URL vers laquelle Auth0 doit rediriger votre application après la déconnexion. Il s’agit d’une
        URL qui utilise votre schéma personnalisé enregistré et votre Domaine Auth0. Ajoutez‑la à votre configuration
        **URL de déconnexion autorisées** dans l’Auth0 Dashboard.
      * Effectuez la déconnexion à partir du SDK en appelant `logout` et transmettez votre URL de redirection dans le
        paramètre `logoutParams.returnTo`.
      * Définissez le paramètre `openUrl` sur un callback qui utilise le plugin Browser de Capacitor pour ouvrir l’URL
        à l’aide de `Browser.open`.

      <Info>
        Comme pour l’étape de connexion, si vous ne définissez pas `openUrl` lorsque vous appelez `logout`,
        le SDK redirige l’utilisateur vers l’URL de déconnexion à l’aide du navigateur par défaut de l’appareil, ce qui
        offre une expérience utilisateur sous‑optimale.
      </Info>

      <Note>
        ##### Point de contrôle

        Offrez un moyen à vos utilisateurs de se déconnecter de votre application. Vérifiez la redirection vers Auth0
        puis vers l’adresse que vous avez indiquée dans le paramètre `returnTo`. Assurez‑vous que les utilisateurs
        ne sont plus connectés à votre application.
      </Note>

      <AuthCodeGroup>
        <Logoutbutton />

        <AppModule />

        <AppComponent />

        <Loginbutton />

        <Userprofile />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[7].id} title={sections[7].title} stepNumber="8" isSingleColumn>
      La trousse de développement logiciel (SDK) Auth0 récupère les informations de profil
      associées aux utilisateurs connectés dans n’importe quel composant où vous en avez besoin, comme leur nom ou leur photo de profil, afin de
      personnaliser l’interface utilisateur. Les informations de profil sont accessibles par l’entremise de la propriété `user$`
      exposée par `AuthService`.

      <Note>
        ##### Point de contrôle

        Offrez à vos utilisateurs un moyen de voir les détails de leur profil utilisateur dans l’application et vérifiez que vous êtes en mesure de
        récupérer et d’afficher vos informations de profil à l’écran une fois que vous vous êtes connecté à l’application.
      </Note>

      <AuthCodeGroup>
        <Userprofile />

        <AppModule />

        <AppComponent />

        <Loginbutton />

        <Logoutbutton />
      </AuthCodeGroup>
    </Section>

    ## Prochaines étapes

    Excellent travail! Si vous vous êtes rendu jusqu&#39;ici, vous devriez maintenant avoir la connexion, la déconnexion et les informations de profil utilisateur qui fonctionnent dans votre application.

    Ce tutoriel de démarrage rapide est maintenant terminé, mais il reste encore beaucoup à découvrir. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Découvrez comment configurer et gérer votre tenant Auth0 et vos applications
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Découvrez les intégrations que vous pouvez activer afin d’étendre les fonctionnalités d’Auth0
  </Content>
</Recipe>