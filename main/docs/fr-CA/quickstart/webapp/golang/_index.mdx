---
title: Ajouter une connexion à votre application Go

sidebarTitle: Go
---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/fr-CA/recipe.jsx";
import { LoggedInForm } from "/snippets/fr-CA/Login.jsx";

import Auth from "/snippets/fr-CA/quickstart/webapp/golang/auth.go.mdx";
import Callback from "/snippets/fr-CA/quickstart/webapp/golang/callback.go.mdx";
import Env from "/snippets/quickstart/webapp/golang/.env.mdx";
import Go from "/snippets/fr-CA/quickstart/webapp/golang/go.mod.mdx";
import Isauthenticated from "/snippets/fr-CA/quickstart/webapp/golang/isAuthenticated.go.mdx";
import Login from "/snippets/fr-CA/quickstart/webapp/golang/login.go.mdx";
import Logout from "/snippets/fr-CA/quickstart/webapp/golang/logout.go.mdx";
import Main from "/snippets/fr-CA/quickstart/webapp/golang/main.go.mdx";
import Router from "/snippets/fr-CA/quickstart/webapp/golang/router.go.mdx";
import User from "/snippets/fr-CA/quickstart/webapp/golang/user.go.mdx";

import {AuthCodeGroup} from "/snippets/fr-CA/AuthCodeGroup.jsx";

export const sections = [
      { id: "configure-auth0", title: "Configurer Auth0" },
      { id: "install-dependencies", title: "Installer les dépendances" },
      { id: "configure-the-environment-variables", title: "Configurer les variables d'environnement" },
      { id: "configure-oauth2-and-openid-connect-packages", title: "Configurer les packages OAuth2 et OpenID Connect" },
      { id: "set-up-your-application-routes", title: "Configurer les routes de votre application" },
      { id: "add-login-to-your-application", title: "Ajouter la connexion à votre application" },
      { id: "handle-authentication-callback", title: "Gérer le callback d'authentification" },
      { id: "display-user-profile-information", title: "Afficher les informations de profil de l'utilisateur" },
      { id: "add-logout-to-your-application", title: "Ajouter la déconnexion à votre application" },
      { id: "protect-routes", title: "Protéger les routes" },
      { id: "serve-your-application", title: "Exécuter votre application" }
]


<Recipe isSingleColumn>
  <Content>
    Auth0 vous permet d&#39;ajouter l&#39;authentification et d&#39;accéder aux informations de profil utilisateur dans votre application. Ce guide
    explique comment intégrer Auth0 à n&#39;importe quelle application Web Go, nouvelle ou existante.

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Pour utiliser les services Auth0, vous devez disposer d’une application configurée dans Auth0 Dashboard. C’est dans cette application Auth0
      que vous configurerez le fonctionnement de l’authentification pour le projet que vous développez.

      ### Configurer une application

      Utilisez le sélecteur interactif pour créer une nouvelle application Auth0 ou sélectionner une application existante qui représente
      le projet que vous voulez intégrer. Chaque application dans Auth0 se voit attribuer un ID client alphanumérique unique
      que le code de votre application utilisera pour appeler les API Auth0 au moyen de la trousse de développement logiciel (SDK).

      Tous les paramètres que vous configurez à l’aide de ce démarrage rapide seront automatiquement mis à jour pour votre Application dans le [Dashboard](https://manage.auth0.com/dashboard/us/auth0-dsepaid/), où vous pourrez gérer vos Applications par la suite.

      Si vous préférez explorer une configuration complète, vous pouvez plutôt consulter une application d’exemple.

      ### Configurer les URL de rappel (Callback)

      Une URL de rappel (callback) est une URL dans votre application vers laquelle vous voulez qu’Auth0 redirige les utilisateurs une fois qu’ils se sont
      authentifiés. Si elle n’est pas définie, les utilisateurs ne seront pas renvoyés à votre application après s’être connectés.

      <Info>
        Si vous suivez notre projet d’exemple, définissez-la sur
        `http://localhost:3000/callback`.
      </Info>

      ### Configurer les URL de déconnexion (Logout)

      Une URL de déconnexion est une URL dans votre application vers laquelle vous voulez qu’Auth0 redirige les utilisateurs une fois qu’ils se sont
      déconnectés. Si elle n’est pas définie, les utilisateurs ne pourront pas se déconnecter de votre application et recevront une erreur.

      <Info>
        Si vous suivez notre projet d’exemple, définissez-la sur `http://localhost:3000`.
      </Info>

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      Créez un fichier `go.mod` pour répertorier toutes les dépendances de votre application.

      Pour intégrer Auth0 dans une application Go, ajoutez les packages `coreos/go-oidc/v3` et `x/oauth2`.

      En plus des packages OIDC et OAuth2, ajoutez `joho/godotenv`, `gin-gonic/gin` et
      `gin-contrib/sessions`.

      <Info>
        Cet exemple utilise `gin` pour le routage, mais vous pouvez utiliser le routeur de votre choix.
      </Info>

      Enregistrez le fichier `go.mod` avec les dépendances nécessaires et installez-les au moyen de la commande suivante dans
      votre terminal :

      ```text lines
      go mod download
      ```

      <AuthCodeGroup>
        <User />

        <Auth />

        <Callback />

        <Env />

        <Go />

        <Isauthenticated />

        <Login />

        <Logout />

        <Main />

        <Router />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Vous devez définir les variables d’environnement suivantes dans le fichier `.env` à la racine de votre projet :

      * **AUTH0&#95;DOMAIN** : Le domaine de votre tenant Auth0. Trouvez votre Domaine Auth0 dans l’Auth0 Dashboard, dans les paramètres de votre Application, dans le champ Domaine. Pour les domaines personnalisés, définissez plutôt cette valeur sur votre Domaine personnalisé.
      * **AUTH0&#95;CLIENT&#95;ID** : L’ID de l’Application Auth0 que vous avez configurée plus tôt dans ce Démarrage rapide. Vous la trouverez dans l’Auth0 Dashboard, dans les paramètres de votre Application, dans le champ ID client.
      * **AUTH0&#95;CLIENT&#95;SECRET** : Le secret de l’Application Auth0 que vous avez configurée plus tôt dans ce Démarrage rapide. Vous le trouverez dans l’Auth0 Dashboard, dans les paramètres de votre Application, dans le champ Secret client.
      * **AUTH0&#95;CALLBACK&#95;URL** : L’URL utilisée par Auth0 pour rediriger l’utilisateur après une authentification réussie.

      <AuthCodeGroup>
        <Env />

        <Auth />

        <Callback />

        <Go />

        <Isauthenticated />

        <Login />

        <Logout />

        <Main />

        <Router />

        <User />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      Ensuite, configurez les paquets OAuth2 et OpenID Connect.

      Créez un fichier nommé `auth.go` dans le dossier `platform/authenticator`. Dans ce package,
      créez une méthode pour configurer et renvoyer les clients [OAuth2](https://godoc.org/golang.org/x/oauth2) et [OIDC](https://godoc.org/github.com/coreos/go-oidc), ainsi qu&#39;une autre pour vérifier un jeton d&#39;identité.

      <AuthCodeGroup>
        <Auth />

        <Callback />

        <Env />

        <Go />

        <Isauthenticated />

        <Login />

        <Logout />

        <Main />

        <Router />

        <User />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Créez un fichier nommé `router.go` dans le dossier `platform/router`. Dans ce package, créez une
      méthode pour configurer et renvoyer nos routes en utilisant [github.com/gin-gonic/gin](https://github.com/gin-gonic/gin). Vous passerez une instance de
      `Authenticator` à la méthode pour l’utiliser avec les gestionnaires `login` et `callback`.

      <AuthCodeGroup>
        <Router />

        <Auth />

        <Callback />

        <Env />

        <Go />

        <Isauthenticated />

        <Login />

        <Logout />

        <Main />

        <User />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      Pour que l&#39;utilisateur puisse s&#39;authentifier, nous devons créer une fonction gestionnaire pour la route `/login`.

      Créez un fichier nommé `login.go` dans le dossier `web/app/login`, et ajoutez une
      fonction `Handler`. Lors de l&#39;exécution du gestionnaire, l&#39;utilisateur sera redirigé vers Auth0 où il pourra
      entrer ses identifiants.

      Pour appeler la route `/login`, ajoutez un lien vers `/login` dans le modèle `home.html`
      situé dans le répertoire `web/template`.

      <AuthCodeGroup>
        <Login />

        <Auth />

        <Callback />

        <Env />

        <Go />

        <Isauthenticated />

        <Logout />

        <Main />

        <Router />

        <User />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7" isSingleColumn>
      Une fois que les utilisateurs se sont authentifiés à l’aide de la page Universal Login d’Auth0, ils reviennent à l’application à la route
      `/callback`.

      Créez un fichier nommé `callback.go` dans le dossier `web/app/callback`, et ajoutez une fonction
      `Handler`.

      Ce gestionnaire récupère le paramètre de requête `code`, fourni par Auth0, et l’échange contre un jeton ID et
      un jeton d’accès.

      Si le jeton ID est valide, il enregistre les informations de profil et le jeton d’accès dans la session. Les informations de profil
      sont basées sur les déclarations (claims) contenues dans le jeton ID. Le stockage en session permet à l’application d’accéder
      à ces informations au besoin.

      <AuthCodeGroup>
        <Callback />

        <Auth />

        <Env />

        <Go />

        <Isauthenticated />

        <Login />

        <Logout />

        <Main />

        <Router />

        <User />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[7].id} title={sections[7].title} stepNumber="8" isSingleColumn>
      Maintenant que vos utilisateurs peuvent se connecter, vous voudrez probablement pouvoir récupérer et utiliser les informations de profil associées aux utilisateurs authentifiés.

      Vous pouvez accéder à ces informations de profil, comme leur surnom ou leur photo de profil, au moyen du
      `profile` qui a été stocké précédemment dans la session.

      Créez un gestionnaire pour le endpoint `/user` dans `web/app/user/user.go` et retournez le
      fichier HTML correspondant. Comme le `profile` est transmis à `ctx.HTML()`, vous pouvez accéder
      aux informations de profil comme `picture` et `nickname` dans ce même fichier HTML.

      Un exemple d’un tel fichier HTML pourrait ressembler à l’exemple ci-dessous, mais vous pouvez récupérer n’importe quelle information de profil,
      y compris des claims personnalisées.

      <AuthCodeGroup>
        <User />

        <Auth />

        <Callback />

        <Env />

        <Go />

        <Isauthenticated />

        <Login />

        <Logout />

        <Main />

        <Router />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[8].id} title={sections[8].title} stepNumber="9" isSingleColumn>
      Pour déconnecter l’utilisateur, supprimez les données de la session et redirigez l’utilisateur vers le point de terminaison de déconnexion Auth0. Vous pouvez
      trouver plus d’informations à ce sujet dans la [documentation sur la déconnexion](https://auth0.com/docs/logout).

      Créez un fichier nommé `logout.go` dans le dossier `web/app/logout`, et ajoutez la fonction
      `Handler` pour rediriger l’utilisateur vers le point de terminaison de déconnexion d’Auth0.

      L’URL `returnTo` doit figurer dans la liste des URL de déconnexion autorisées dans la section des paramètres de
      l’Application. Pour plus d’informations, consultez [Rediriger les utilisateurs après la déconnexion](https://auth0.com/docs/logout/guides/redirect-users-after-logout).

      Créez un fichier nommé `user.js` dans le dossier `web/static/js`, et ajoutez le code pour supprimer
      le cookie d’un utilisateur connecté.

      <AuthCodeGroup>
        <Logout />

        <Auth />

        <Callback />

        <Env />

        <Go />

        <Isauthenticated />

        <Login />

        <Main />

        <Router />

        <User />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[9].id} title={sections[9].title} stepNumber="10" isSingleColumn>
      Les bonnes pratiques veulent que certaines routes ne soient accessibles qu’aux utilisateurs authentifiés. Lorsque des utilisateurs non authentifiés tentent d’accéder à des routes protégées, votre application doit les rediriger.

      Dans ce cas, vous allez implémenter un middleware pour intercepter la requête HTTP. La fonction de middleware détermine si la requête doit être acheminée vers le gestionnaire du point de terminaison ou si elle doit être bloquée.

      Créez un fichier nommé `isAuthenticated.go` dans `platform/middleware` et ajoutez une fonction qui vérifie si l’utilisateur est authentifié ou non en se basant sur la clé de session `profile`. Si l’utilisateur n’est pas authentifié, le middleware le redirigera vers la racine de l’application.

      Une fois le middleware créé, vous pouvez le configurer sur n’importe quelle route nécessitant une authentification en l’ajoutant au routeur.

      <AuthCodeGroup>
        <Isauthenticated />

        <Auth />

        <Callback />

        <Env />

        <Go />

        <Login />

        <Logout />

        <Main />

        <Router />

        <User />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[10].id} title={sections[10].title} stepNumber="11" isSingleColumn>
      Une fois l’authentificateur et le routeur configurés, nous pouvons les relier en utilisant le point d’entrée de notre application.
      Dans `main.go`, créez une instance de l’authentificateur et du routeur, à laquelle vous passez l’instance de l’authentificateur.

      Si vous utilisez un fichier `.env`, vous devez appeler `godotenv.Load()` tout au début de
      la fonction `main()`.

      Servez votre application à l’aide de la commande suivante dans votre terminal :

      ```text lines
      go run main.go
      ```

      <AuthCodeGroup>
        <Main />

        <Auth />

        <Callback />

        <Env />

        <Go />

        <Isauthenticated />

        <Login />

        <Logout />

        <Router />

        <User />
      </AuthCodeGroup>
    </Section>

    ## Prochaines étapes

    Excellent travail! Si vous vous êtes rendu jusqu&#39;ici, vous devriez maintenant avoir la connexion, la déconnexion et les informations de profil utilisateur qui fonctionnent dans votre application.

    Ce tutoriel de démarrage rapide est maintenant terminé, mais il reste encore beaucoup à découvrir. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Apprenez à configurer et à gérer votre tenant Auth0 et vos applications
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Découvrez des intégrations qui vous permettent d’étendre les fonctionnalités d’Auth0
  </Content>
</Recipe>