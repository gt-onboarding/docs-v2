---
title: Ajouter une fonctionnalité de connexion à votre application Java Servlet

sidebarTitle: Java
---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/fr-CA/recipe.jsx";
import { LoggedInForm } from "/snippets/fr-CA/Login.jsx";

import Web from "/snippets/fr-CA/quickstart/webapp/java/web.xml.mdx";
import Authenticationcontrollerprovider from "/snippets/fr-CA/quickstart/webapp/java/AuthenticationControllerProvider.java.mdx";
import Loginservlet from "/snippets/fr-CA/quickstart/webapp/java/LoginServlet.java.mdx";
import Callbackservlet from "/snippets/fr-CA/quickstart/webapp/java/CallbackServlet.java.mdx";
import Homeservlet from "/snippets/fr-CA/quickstart/webapp/java/HomeServlet.java.mdx";
import Logoutservlet from "/snippets/fr-CA/quickstart/webapp/java/LogoutServlet.java.mdx";

import {AuthCodeGroup} from "/snippets/fr-CA/AuthCodeGroup.jsx";

export const sections = [
      { id: "configure-auth0", title: "Configurer Auth0" },
      { id: "integrate-auth0-in-your-application", title: "Intégrer Auth0 à votre application" },
      { id: "configure-your-java-application", title: "Configurer votre application Java" },
      { id: "create-the-authenticationcontroller", title: "Créer l’AuthenticationController" },
      { id: "login-redirection", title: "Redirection de la connexion" },
      { id: "handling-the-tokens", title: "Traitement des jetons" },
      { id: "display-the-home-page", title: "Afficher la page d’accueil" },
      { id: "handle-logout", title: "Gérer la déconnexion" },
      { id: "run-the-sample", title: "Exécuter l’exemple" }
]


<Recipe isSingleColumn>
  <Content>
    Auth0 vous permet d&#39;ajouter rapidement l&#39;authentification et d&#39;accéder aux informations du profil utilisateur dans votre application.
    Ce guide explique comment intégrer Auth0 à toute application Java Servlet, nouvelle ou existante.

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Pour utiliser les services Auth0, vous devez avoir une application configurée dans l’Auth0 Dashboard. C’est dans l’application Auth0
      que vous allez configurer le fonctionnement de l’authentification pour le projet que vous développez.

      ### Configurer une application

      Utilisez le sélecteur interactif pour créer une nouvelle application Auth0 ou sélectionner une application existante qui représente
      le projet que vous voulez intégrer. Chaque application dans Auth0 se voit attribuer un ID client alphanumérique unique
      que le code de votre application utilisera pour appeler les API Auth0 par l’intermédiaire de la trousse de développement logiciel (SDK).

      Tous les paramètres que vous configurez à l’aide de ce démarrage rapide seront automatiquement mis à jour pour votre Application dans l’[Auth0 Dashboard](https://manage.auth0.com/#/), où vous pourrez
      gérer vos Applications ultérieurement.

      Si vous préférez explorer une configuration complète, vous pouvez plutôt consulter une application d’exemple.

      ### Configurer les URL de rappel (Callback)

      Une URL de rappel est une URL dans votre application vers laquelle vous voulez qu’Auth0 redirige les utilisateurs après leur
      authentification. Si elle n’est pas configurée, les utilisateurs ne seront pas renvoyés à votre application après leur connexion.

      <Info>
        Si vous suivez notre projet d’exemple, définissez cette valeur sur
        `http://localhost:3000/callback`.
      </Info>

      ### Configurer les URL de déconnexion

      Une URL de déconnexion est une URL dans votre application vers laquelle vous voulez qu’Auth0 redirige les utilisateurs après leur
      déconnexion. Si elle n’est pas configurée, les utilisateurs ne pourront pas se déconnecter depuis votre application et recevront une erreur.

      <Info>
        Si vous suivez notre projet d’exemple, définissez cette valeur sur `http://localhost:3000/`.
      </Info>

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      ### Configurer les dépendances

      Pour intégrer votre application Java à Auth0, ajoutez les dépendances suivantes :

      * **javax.servlet-api**
        : est la bibliothèque qui vous permet de créer des Servlets Java. Vous devez ensuite ajouter une dépendance de serveur d’applications comme
        Tomcat ou Gretty, le choix vous appartient. Consultez notre code d’exemple pour plus d’informations.
      * **auth0-java-mvc-commons** : est la [bibliothèque Java](https://github.com/auth0/auth0-java-mvc-common) qui vous permet d’utiliser Auth0 avec Java pour
        les applications web MVC côté serveur. Elle génère l’URL Authorize que vous devez appeler pour procéder à l’authentification et
        valide le résultat reçu au retour afin d’obtenir finalement les [jetons Auth0](https://auth0.com/docs/tokens) qui identifient l’utilisateur.

      Si vous utilisez Gradle, ajoutez-les à votre `build.gradle` :

      ```text lines
      // build.gradle
      compile 'javax.servlet:javax.servlet-api:3.1.0'
      compile 'com.auth0:mvc-auth-commons:1.+'W
      ```

      Si vous utilisez Maven, ajoutez-les dans votre fichier `pom.xml` :

      ```text lines
      <!-- pom.xml -->
      <dependency>
      <groupId>com.auth0</groupId>
      <artifactId>mvc-auth-commons</artifactId>
      <version>[1.0, 2.0)</version>
      </dependency>
      <dependency>
      <groupId>javax.servlet</groupId>
      <artifactId>javax.servlet-api</artifactId>
      <version>3.1.0</version>
      </dependency>
      ```

      <LoggedInForm />
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Votre application Java a besoin de certaines informations pour pouvoir s’authentifier auprès de votre compte Auth0. Les exemples récupèrent ces informations dans le descripteur de déploiement `src/main/webapp/WEB-INF/web.xml`, mais vous pouvez les stocker ailleurs.

      Ces informations seront utilisées pour configurer la bibliothèque **auth0-java-mvc-commons** afin de permettre aux utilisateurs de se connecter à votre application. Pour en savoir plus sur la bibliothèque, y compris ses différentes options de configuration, consultez la [documentation de la bibliothèque](https://github.com/auth0/auth0-java-mvc-common/blob/master/README.md).

      ### Vérifier les attributs renseignés

      Si vous avez téléchargé cet exemple à l’aide du bouton **Download Sample**, les attributs `domain`, `clientId` et `clientSecret` seront déjà préremplis. Vous devez vérifier que les valeurs sont correctes, surtout si vous avez plusieurs applications Auth0 dans votre compte.

      ### Structure du projet

      Le projet d’exemple, qui peut être téléchargé à l’aide du bouton **Download Sample**, présente la structure suivante :

      ```text lines
      - src
      -- main
      ---- java
      ------ com
      -------- auth0
      ---------- example
      ------------ Auth0Filter.java
      ------------ AuthenticationControllerProvider.java
      ------------ HomeServlet.java
      ------------ CallbackServlet.java
      ------------ LoginServlet.java
      ------------ LogoutServlet.java
      ---- webapp
      ------ WEB-INF
      -------- jsp
      ---------- home.jsp
      -------- web.xml

      build.gradle
      ```

      Le projet contient une seule page JSP : `home.jsp`, qui affichera les jetons associés à l’utilisateur
      après une connexion réussie et offrira l’option de déconnexion.

      Le projet contient un WebFilter : `Auth0Filter.java`, qui vérifiera l’existence de jetons avant
      de donner à l’utilisateur accès à notre chemin protégé `/portal/*`. Si les jetons n’existent pas,
      la requête sera redirigée vers le `LoginServlet`.

      Le projet contient aussi quatre servlets :

      * `LoginServlet.java` : Invoqué lorsque l’utilisateur tente de se connecter. Le servlet utilise les
        paramètres `client_id` et `domain` pour créer une URL Authorize valide et y redirige
        l’utilisateur.
      * `CallbackServlet.java` : Le servlet intercepte les requêtes vers notre URL de rappel (Callback) et traite les données
        pour obtenir les informations d’identification. Après une connexion réussie, ces informations sont ensuite enregistrées dans
        l’`HttpSession` de la requête.
      * `HomeServlet.java` : Le servlet lit les jetons précédemment enregistrés et les affiche dans la
        ressource `home.jsp`.
      * `LogoutServlet.java` : Invoqué lorsque l’utilisateur clique sur le lien de déconnexion. Le servlet invalide la
        session de l’utilisateur et le redirige vers la page de connexion, gérée par le `LoginServlet`.
      * `AuthenticationControllerProvider.java` : Chargé de créer et de gérer une instance unique de
        `AuthenticationController`

      <AuthCodeGroup>
        <Web />

        <Authenticationcontrollerprovider />

        <Loginservlet />

        <Callbackservlet />

        <Homeservlet />

        <Logoutservlet />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      Pour permettre aux utilisateurs de s’authentifier, créez une instance de `AuthenticationController` fournie par la Trousse de développement logiciel (SDK) `auth0-java-mvc-commons` en utilisant `domain`, `clientId` et
      `clientSecret`. L’exemple montre comment configurer le composant pour une utilisation avec des jetons signés à l’aide de l’algorithme de signature asymétrique RS256, en spécifiant un `JwkProvider` pour récupérer la clé publique utilisée pour
      vérifier la signature du jeton. Consultez le [dépôt jwks-rsa-java](https://github.com/auth0/jwks-rsa-java) pour en savoir plus sur les options de configuration supplémentaires. Si vous
      utilisez HS256, il n’est pas nécessaire de configurer le `JwkProvider`.

      <Info>
        `AuthenticationController` ne stocke aucun contexte et est conçu pour être réutilisé.
        La création inutile de nouvelles instances peut entraîner la création de ressources supplémentaires qui pourraient avoir une incidence sur les performances.
      </Info>

      <AuthCodeGroup>
        <Authenticationcontrollerprovider />

        <Web />

        <Loginservlet />

        <Callbackservlet />

        <Homeservlet />

        <Logoutservlet />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Pour permettre aux utilisateurs de se connecter, votre application les redirigera vers la page Universal Login. À l’aide de l’instance `AuthenticationController`, vous pouvez générer l’URL de redirection en appelant la méthode
      `buildAuthorizeUrl(HttpServletRequest request`, `HttpServletResponse response`,
      `String redirectUrl)`. L’URL de redirection doit correspondre à l’URL qui a été ajoutée à la liste des **Allowed Callback URLs** de votre application Auth0.

      <AuthCodeGroup>
        <Loginservlet />

        <Web />

        <Authenticationcontrollerprovider />

        <Callbackservlet />

        <Homeservlet />

        <Logoutservlet />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      Une fois l’utilisateur connecté, le résultat sera reçu dans notre `CallbackServlet` au moyen d’une requête HTTP
      GET ou POST. Comme nous utilisons l’Authorization Code Flow (valeur par défaut), une requête GET sera envoyée. Si
      vous avez configuré la bibliothèque pour l’Implicit Flow, une requête POST sera envoyée à la place.

      La requête contient le contexte d’appel que la bibliothèque a précédemment défini en générant l’URL Authorize avec
      `AuthenticationController`. Lorsque cette requête est transmise au contrôleur, vous obtenez soit une instance
      `Tokens` valide, soit une exception indiquant la cause de l’erreur. En cas d’appel réussi, vous devez
      enregistrer les informations d’identification quelque part pour pouvoir y accéder plus tard. Vous pouvez utiliser
      l’`HttpSession` de la requête à l’aide de la classe `SessionsUtils` incluse dans la bibliothèque.

      <Info>
        Il est recommandé d’enregistrer le moment où nous avons demandé les tokens ainsi que la valeur
        `expiresIn` reçue, afin que, la prochaine fois que nous allons utiliser le token, nous puissions
        vérifier s’il a déjà expiré ou s’il est encore valide. Pour les besoins de cet exemple, nous allons
        ignorer cette validation.
      </Info>

      <AuthCodeGroup>
        <Callbackservlet />

        <Web />

        <Authenticationcontrollerprovider />

        <Loginservlet />

        <Homeservlet />

        <Logoutservlet />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7" isSingleColumn>
      Maintenant que l&#39;utilisateur est authentifié (les jetons existent), le `Auth0Filter` lui permet d&#39;accéder
      à nos ressources protégées. Dans `HomeServlet`, nous récupérons les jetons à partir de la session de la requête et nous les stockons
      dans l&#39;attribut `userId` afin qu&#39;ils puissent être utilisés dans le code JSP.

      <AuthCodeGroup>
        <Homeservlet />

        <Web />

        <Authenticationcontrollerprovider />

        <Loginservlet />

        <Callbackservlet />

        <Logoutservlet />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[7].id} title={sections[7].title} stepNumber="8" isSingleColumn>
      Pour gérer correctement la déconnexion, nous devons vider la session et déconnecter l’utilisateur d’Auth0. Cette opération est gérée dans le
      `LogoutServlet` de notre application d’exemple.

      D’abord, nous vidons la session en appelant `request.getSession().invalidate()`. Nous construisons ensuite l’URL de déconnexion, en veillant à inclure le paramètre de requête `returnTo`, qui indique l’endroit où l’utilisateur sera
      redirigé après la déconnexion. Enfin, nous redirigeons la réponse vers notre URL de déconnexion.

      <AuthCodeGroup>
        <Logoutservlet />

        <Web />

        <Authenticationcontrollerprovider />

        <Loginservlet />

        <Callbackservlet />

        <Homeservlet />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[8].id} title={sections[8].title} stepNumber="9" isSingleColumn>
      Pour exécuter l’exemple à partir d’un terminal, placez-vous dans le dossier racine du projet, puis exécutez la commande suivante :

      ```text lines
      ./gradlew clean app
      ```

      Après quelques secondes, l&#39;application sera accessible à l&#39;adresse `http://localhost:3000/`. Essayez d&#39;accéder à la
      ressource protégée [http://localhost:3000/portal/home](http://localhost:3000/portal/home) et remarquez que vous êtes redirigé par
      `Auth0Filter` vers la page de connexion Auth0. Le widget affiche toutes les connexions sociales et bases de données que
      vous avez définies pour cette application dans le [tableau de bord](https://manage.auth0.com/#/).

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/7L6lZ6xCi1L7sJBFZUPb9g/b7697bfa1bc83a1072c2de2f15cec93c/Login_Screen_-_English.png" />
      </Frame>

      Après une authentification réussie, vous pourrez voir le contenu de la page d&#39;accueil.

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/FzK3jxfSGoeIDYQamxnJl/6b608e39ff39e044644193cfd2ee0f69/java-step-9-2.png" />
      </Frame>

      Déconnectez-vous en cliquant sur le bouton **Déconnexion** en haut à droite de la page d&#39;accueil.

      <LoggedInForm />
    </Section>

    ## Prochaines étapes

    Excellent travail! Si vous vous êtes rendu jusqu&#39;ici, vous devriez maintenant avoir la connexion, la déconnexion et les informations de profil utilisateur qui fonctionnent dans votre application.

    Ce tutoriel de démarrage rapide est maintenant terminé, mais il reste encore beaucoup à découvrir. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Apprenez à configurer et à gérer votre locataire Auth0 et vos applications
    * [Trousse de développement logiciel (SDK) auth0-java-mvc-common](https://github.com/auth0/auth0-java-mvc-common) - Découvrez plus en détail la trousse de développement logiciel (SDK) utilisée dans ce tutoriel
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Découvrez des intégrations permettant d’étendre les fonctionnalités d’Auth0
  </Content>
</Recipe>