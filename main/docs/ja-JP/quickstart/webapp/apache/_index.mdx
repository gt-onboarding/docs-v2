---
title: "Apache"

---

import {AuthCodeGroup} from "/snippets/ja-JP/AuthCodeGroup.jsx";

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/ja-JP/recipe.jsx"
import Code1 from "/snippets/ja-JP/quickstart/webapp/apache/code1.mdx"
import Code2 from "/snippets/ja-JP/quickstart/webapp/apache/code2.mdx"

export const sections = [
  { id: "system-requirements", title: "システム要件" },
  { id: "install-and-enable-mod-auth-openidc-module", title: "mod_auth_openidc モジュールのインストールと有効化" },
  { id: "configure-the-module-with-your-auth0-account-information", title: "Auth0 アカウント情報を使用したモジュールの設定" },
  { id: "configure-auth0", title: "Auth0 の設定" },
  { id: "authorization", title: "認可" }
]


<Recipe isSingleColumn>
  <Content>
    このチュートリアルでは、Apache を構成して Web アプリケーションに認証と認可を追加する方法を説明します。このクイックスタートに沿って進めるにあたり、ご自身のアカウント用に構成されたサンプルを使用できるよう、事前にログインすることを推奨します。

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      このチュートリアルとサンプルプロジェクトは、次の環境でテストされています。

      - Apache 2.4
    
    <LoggedInForm />
</Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      まず、Apache 用の `mod_auth_openidc` モジュールをインストールします。

      バイナリは [GitHub](https://github.com/zmartzone/mod_auth_openidc/releases) から入手し、ご利用の OS 向けにインストールできます。OS がいずれのバイナリとも互換性がない場合でも、[ソースからビルド](https://github.com/zmartzone/mod_auth_openidc/blob/master/INSTALL) できます。

      モジュールをインストールしたら、`a2enmod` コマンドを使って Apache で有効化します。詳細は、[Ubuntu Manpage の a2enmod](https://manpages.ubuntu.com/manpages/focal/man8/a2enmod.8.html) を参照してください。

      ```text lines
      a2enmod auth_openidc
      ```

      <Info>
      Windows の場合は、[この Powershell スクリプト](https://github.com/enderandpeter/win-a2enmod#installation) を使用すると、システム上で `a2enmod` を動作させることができます。
      </Info>
    
    <LoggedInForm />
</Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      `/etc/apache2/mods-available` フォルダー内にある新しい設定ファイル (`auth_openidc.conf`) を更新します。

      <Info>
      Windows の場合は、`/apache/conf/httpd.conf` ファイルを使用する必要があります。
      </Info>
    
    <AuthCodeGroup>
            <Code1/>
          </AuthCodeGroup>
</Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      Auth0 Dashboard で、次の操作を行います。

      1. **Applications** > **Applications** に移動し、一覧から対象のアプリケーションを選択します。
      2. **Settings** ビューに切り替え、**Application URIs** セクションを探します。
      3. `OIDCRedirectURI` の値を **許可されたコールバックURL** に追加します。
      4. ページ下部の **Advanced Settings** を探します。
      5. **OAuth** ビューに切り替えます。
      6. **JSON Web Token (JWT) Signature Algorithm** を `RS256` に設定します。
    
    <LoggedInForm />
</Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      `auth_openidc.conf` ファイルに `Location` ブロックを追加することで、ユーザーの IDトークン に含まれるクレームの値に基づいて特定のパスを保護するように Apache を構成できます。

      たとえば、ユーザーのロールを読み取り、保護されたパスへのアクセスを許可するクレームを追加する Action を作成できます。

      ```js lines
      exports.onExecutePostLogin = async (event, api) => {
        const roles = event.authorization.roles; // ['user', 'admin']
          if (roles.includes('admin')) {
          api.idToken.setCustomClaim('folder', 'admin');
        }
      };
      ```
    
    <AuthCodeGroup>
            <Code2/>
          </AuthCodeGroup>
</Section>

    ## Next Steps
    ここまで完了していれば、アプリケーションでログイン、ログアウト、およびユーザープロファイル情報が動作しているはずです。

    これでクイックスタートのチュートリアルは終了ですが、Auth0 でできることは他にも多数あります。詳しくは次を参照してください。

    - [Auth0 Dashboard](https://manage.auth0.com/) - Auth0 のテナントとアプリケーションの構成と管理方法について学ぶ

    - [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0 の機能を拡張するために有効化できる各種連携機能を確認する
  </Content>

  
</Recipe>