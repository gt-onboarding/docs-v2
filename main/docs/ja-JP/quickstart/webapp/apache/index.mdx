---
title: "Apache"
permalink: "01-login"
---

import {AuthCodeBlock} from "/snippets/ja-JP/AuthCodeBlock.jsx";

コミュニティによってメンテナンスされています

このチュートリアルでは、Auth0 Apache ソフトウェア開発キット (SDK) を使用して、Web アプリケーションに認証と認可を追加する方法を説明します。ご利用のアカウント用に設定されたサンプルを使ってこのクイックスタートを進められるよう、ログインすることを推奨します。

<Note>
  ### システム要件

  このチュートリアルとシードプロジェクトは、次の環境でテストされています。

  * Apache 2.4
</Note>

**Apache を使用して Auth0 と OpenID Connect で動作するようアプリケーションを構成するには、以下の手順に従ってください。**


<div id="install-and-enable-mod_auth_openidc-module">
  ## mod&#95;auth&#95;openidc モジュールをインストールして有効化する
</div>

まず、Apache 用の `mod_auth_openidc` モジュールをインストールする必要があります。

[GitHub](https://github.com/zmartzone/mod_auth_openidc/releases) からバイナリを取得し、使用している OS 向けにインストールできます。OS がいずれのバイナリとも互換性がない場合でも、[ソースからビルド](https://github.com/zmartzone/mod_auth_openidc/blob/master/INSTALL) できます。

インストールが完了したら、あとは Apache でこのモジュールを有効化するだけです（Windows を使用している場合は、システム上で `a2enmod` を動作させるために [こちら](https://github.com/enderandpeter/win-a2enmod#installation) を利用できます）。

```bash lines
a2enmod auth_openidc
```


<div id="configure-the-module-with-your-auth0-account-information">
  ## Auth0 アカウント情報でモジュールを設定する
</div>

これで、新しい設定ファイルが `/etc/apache2/mods-available` ディレクトリ内に作成されているはずです。ここは Apache モジュールが通常インストールされる場所です（Windows の場合は `/apache/conf/httpd.conf` ファイルを使用する必要があります）。

そのファイルに、`mod_auth_openidc` モジュール向けに次の設定を追加します。

export const codeExample = `# mods-available/auth_openidc.conf

OIDCProviderMetadataURL https://{yourDomain}/.well-known/openid-configuration
OIDCClientID {yourClientId}
OIDCClientSecret '{yourClientSecret}'

OIDCScope "openid name email"
OIDCRedirectURI https://your_apache_server/your_path/redirect_uri/
OIDCCryptoPassphrase <Cookie 上のセッション情報を暗号化するためのパスフレーズ>

<Location /your_path>
   AuthType openid-connect
   Require valid-user
   LogLevel debug
</Location>`;

<AuthCodeBlock children={codeExample} language="conf" />


<div id="configuring-auth0-settings">
  ## Auth0 の設定
</div>

アプリケーションの設定で、`OIDCRedirectURI` を新しい許可済みコールバックとして追加します。

次に、詳細設定内の OAuth セクションに移動し、`JsonWebToken Token Signature Algorithm` を RS256 に設定します。

<div id="authorization">
  ## 認可
</div>

ユーザーの属性に基づいて、Apache を構成して特定のパスを保護できます。次に例を示します。

```conf lines
# mods-available/auth_openidc.conf

<Location /example>
   AuthType openid-connect
   #有効なユーザーを要求
   Require claim folder:example
</Location>

<Location /example2>
   AuthType openid-connect
   #有効なユーザーを要求
   Require claim folder:example2
</Location>
```

次に、`folder` 属性を返す Auth0 ルールを作成できます。

```javascript lines
function(user, context, callback) {
    if (somecondition()) {
       user.folder = 'example2';
    }

   user.folder = 'example';
}
```

または、フォルダーの配列を使用することもでき、Apache モジュールはその配列にこれらの値のいずれかが含まれているかどうかをチェックします。

```javascript lines
function(user, context, callback) {
    user.folders = [];
    if (somecondition()) {
       user.folders.push('example2');
    }

   user.folders.push('example');
}
```

[GitHub で編集](https://github.com/auth0/docs/edit/master/articles/quickstart/webapp/apache/01-login.md)
