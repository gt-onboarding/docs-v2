---
title: Expo アプリにログイン機能を追加する
sidebarTitle: Expo

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/ja-JP/recipe.jsx";
import { LoggedInForm } from "/snippets/ja-JP/Login.jsx";
import App from "/snippets/ja-JP/quickstart/native/react-native-expo/App.js.mdx";
import App2 from "/snippets/ja-JP/quickstart/native/react-native-expo/App.js2.mdx";
import App3 from "/snippets/ja-JP/quickstart/native/react-native-expo/App.js3.mdx";
import App4 from "/snippets/ja-JP/quickstart/native/react-native-expo/App.js4.mdx";
import App5 from "/snippets/ja-JP/quickstart/native/react-native-expo/App.js5.mdx";
import App6 from "/snippets/ja-JP/quickstart/native/react-native-expo/App.js6.mdx";

export const sections = [
      { id: "configure-auth0", title: "Auth0 を設定する" },
      { id: "install-dependencies", title: "依存関係をインストールする" },
      { id: "setup-auth0-config-plugin", title: "Auth0 Config プラグインをセットアップする" },
      { id: "generate-native-source-code", title: "ネイティブ ソースコードを生成する" },
      { id: "configure-the-auth0provider-component", title: "Auth0Provider コンポーネントを構成する" },
      { id: "add-login-to-your-application", title: "アプリケーションにログイン機能を追加する" },
      { id: "add-logout-to-your-application", title: "アプリケーションにログアウト機能を追加する" },
      { id: "show-user-profile-information", title: "ユーザー プロファイル情報を表示する" }
]


<Recipe isSingleColumn>
  <Content>
    このクイックスタートは Expo フレームワーク用です。React Native アプリケーションに Auth0 を統合する場合は、React Native クイックスタートを参照してください。

    <Info>
      このソフトウェア開発キット (SDK) は「Expo Go」アプリとは互換性がありません。Custom Dev Client および EAS ビルドでのみ使用できます。
    </Info>

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Auth0 のサービスを利用するには、Auth0 Dashboard 上で Application を作成しておく必要があります。Auth0 の Application は、
      プロジェクトで認証を構成する場所です。

      ### アプリケーションを構成する

      インタラクティブセレクターを使用して新しい Auth0 Application を作成するか、統合したいプロジェクトを表す既存の Application を選択します。Auth0 の各 Application には英数字からなる一意のクライアントID が割り当てられており、
      アプリケーションのコードはこれを使用してソフトウェア開発キット (SDK) 経由で Auth0 API を呼び出します。

      このクイックスタートを使用して構成した設定は、自動的に [Dashboard](https://manage.auth0.com/) 上の Application に反映されます。ここから、
      今後その Application を管理できます。

      完全な構成を確認したい場合は、代わりにサンプルアプリケーションを参照してください。

      ### コールバック URL とログアウト URL を構成する

      Auth0 は、ユーザーをアプリケーションにリダイレクトするために、コールバック URL とログアウト URL を呼び出します。Auth0 はユーザーを認証した後にコールバック URL を、
      セッション Cookie を削除した後にログアウト URL を呼び出します。コールバック URL とログアウト URL を設定しない場合、ユーザーはアプリにログインおよびログアウトできず、
      アプリケーションはエラーを返します。

      アプリのプラットフォームに応じて、対応する URL を **Callback URLs** と **Logout URLs** に追加します。
      カスタムドメインを使用している場合は、Auth0 テナントのドメインではなく、
      カスタムドメインの値を使用してください。

      #### iOS

      ```
      BUNDLE_IDENTIFIER.auth0://{yourDomain}/ios/BUNDLE_IDENTIFIER/callback
      ```

      #### Android

      ```
      PACKAGE_NAME.auth0://{yourDomain}/android/PACKAGE_NAME/callback
      ```

      <Info>
        サンプルプロジェクトを利用している場合は、次の値を使用してください。

        * iOS: `com.auth0samples.auth0://{yourDomain}/ios/com.auth0samples/callback`
        * Android: `com.auth0samples.auth0://{yourDomain}/android/com.auth0samples/callback`
      </Info>

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      このセクションでは、React Native Auth0 モジュールのインストール方法を説明します。

      <Info>
        React Native の詳細については、[公式ドキュメント](https://facebook.github.io/react-native/) を参照してください。
      </Info>

      ### Yarn

      ```bash
      yarn add react-native-auth0
      ```

      <Info>
        `yarn` の詳細については[公式ドキュメント](https://yarnpkg.com/en/docs)を参照してください。
      </Info>

      ### npm

      ```bash
      npm install react-native-auth0 --save
      ```

      <LoggedInForm />
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Auth0 パッケージでは、ビルド時に設定が必要なカスタムのネイティブコードが実行されます。これを行うには、[Expo Config
      Plugin](https://docs.expo.dev/guides/config-plugins/) を使用します。

      `react-native-auth0` プラグインは、[Expo config](https://docs.expo.dev/workflow/configuration/) に追加されます。

      <App />
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      上記の設定を有効にするには、ネイティブコードを生成する必要があります。生成するには、次のコマンドを実行します。

      ```bash
      expo prebuild
      ```

      Expo のコンフィグにまだ指定されていない場合は、[Android package](https://github.com/expo/fyi/blob/main/android-package.md) と [iOS
      bundle identifier](https://github.com/expo/fyi/blob/main/bundle-identifier.md) を入力するよう求められます。

      ```bash
      ? What would you like your Android package name to be? > com.auth0samples # または希望するパッケージ名
      ? What would you like your iOS bundle identifier to be? > com.auth0samples # または希望するバンドル識別子
      ```

      これらの値は、コールバック URL およびログアウト URL を設定するために使用されます。

      <App2 />
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      `useAuth0` フックは、state 管理を行うために React のコンテキストに依存しています。このコンテキストは
      `Auth0Provider` コンポーネントによって提供されます。

      `useAuth0` フックと `Auth0Provider` コンポーネントを
      `react-native-auth0` パッケージからインポートします。

      ```jsx lines
      import {useAuth0, Auth0Provider} from 'react-native-auth0';
      ```

      SDK が正しく動作するようにするには、アプリケーションを `Auth0Provider` コンポーネントでラップし、次のプロパティを設定する必要があります。

      * `domain`: Auth0 テナントのドメイン。通常、Auth0 Dashboard の該当する Auth0 Application の **Settings** の **Domain** フィールドで確認できます。カスタムドメインを使用している場合は、そのカスタムドメインの値を設定してください。
      * `clientId`: このクイックスタートの前の手順で設定した Auth0 Application のクライアントID。これは Auth0 Dashboard の該当する Auth0 Application の **Settings** の **Client ID** フィールドで確認できます。

      <Note>
        ##### チェックポイント

        `Auth0Provider` コンポーネントは正しく構成されているはずです。アプリケーションを実行して、次の点を確認してください。

        * ソフトウェア開発キット (SDK) が正しく初期化されていること
        * アプリケーションが Auth0 に関連するエラーを出していないこと
      </Note>

      <App3 />
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      `useAuth0` フックが提供する `authorize` メソッドを呼び出して、ユーザーを認証します。
      これにより、認証のためにユーザーが Auth0 の Universal Login ページにリダイレクトされ、
      その後アプリケーションに戻ります。

      ユーザーが正常にログインできたことを確認するには、
      フックから提供される `user` プロパティが `null` ではないことを確認してください。

      <Note>
        ##### チェックポイント

        クリック時に `authorize` を呼び出すボタンコンポーネントを追加してください。
        ログインページにリダイレクトされ、その後アプリケーションに戻ることを確認してください。
      </Note>

      <App4 />
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7" isSingleColumn>
      ユーザーをログアウトさせるには、`clearSession` を呼び出して Auth0 のログアウトエンドポイントにリダイレクトします。これにより、認可サーバー上のセッションが削除され、アプリケーションからユーザーがログアウトされます。

      <Note>
        ##### チェックポイント

        `clearSession` を呼び出すログアウトボタンを追加し、Auth0 のログアウトエンドポイントにリダイレクトされたあとに元の画面へ戻ってくることを確認してください。アプリケーションにログインしたままになっていないことを確認できるはずです。
      </Note>

      <App5 />
    </Section>

    <Section id={sections[7].id} title={sections[7].title} stepNumber="8" isSingleColumn>
      `useAuth0` フックは、認証済みユーザーに関する情報を含む `user` オブジェクトを提供します。これを使用して、[IDトークン](https://auth0.com/docs/secure/tokens/id-tokens) からデコードされた、認証済みユーザーのプロファイル情報にアクセスできます。

      ユーザーが認証されていない場合、このプロパティは `null` になります。

      <Note>
        ##### チェックポイント

        ログインし、返された `user` プロパティを確認します。`email` や `name` など、現在のユーザーのプロファイル情報を確認します。
      </Note>

      <App6 />
    </Section>

    ## 次のステップ

    素晴らしい!ここまで進めたなら、アプリケーションでログイン、ログアウト、およびユーザープロファイル情報が実装されているはずです。

    これでクイックスタートチュートリアルは終了ですが、他にも多くの機能があります。Auth0でできることの詳細については、以下をご確認ください:

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Auth0 テナントとアプリケーションの設定および管理方法について説明します
    * [react-native-auth0 ソフトウェア開発キット (SDK)](https://github.com/auth0/react-native-auth0) - このチュートリアルで使用しているソフトウェア開発キット (SDK) をより詳しく見る
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0 の機能を拡張できる連携機能を見つける
  </Content>
</Recipe>