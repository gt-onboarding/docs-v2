---
title: React Native アプリケーションにログイン機能を追加する
sidebarTitle: React Native

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/ja-JP/recipe.jsx";
import { LoggedInForm } from "/snippets/ja-JP/Login.jsx";
import App from "/snippets/ja-JP/quickstart/native/react-native/app.js.mdx";
import App2 from "/snippets/ja-JP/quickstart/native/react-native/app.js2.mdx";
import App3 from "/snippets/ja-JP/quickstart/native/react-native/app.js3.mdx";
import App4 from "/snippets/ja-JP/quickstart/native/react-native/app.js4.mdx";

export const sections = [
      { id: "configure-auth0", title: "Auth0 を設定する" },
      { id: "install-dependencies", title: "依存関係をインストールする" },
      { id: "integrate-auth0-in-your-application", title: "Auth0 をアプリケーションに組み込む" },
      { id: "configure-the-auth0provider-component", title: "Auth0Provider コンポーネントを設定する" },
      { id: "add-login-to-your-application", title: "アプリケーションにログイン機能を追加する" },
      { id: "add-logout-to-your-application", title: "アプリケーションにログアウト機能を追加する" },
      { id: "show-user-profile-information", title: "ユーザー プロファイル情報を表示する" }
]


<Recipe isSingleColumn>
  <Content>
    このクイックスタートは React Native フレームワーク用です。Expo アプリケーションに Auth0 を統合する場合は、[Expo クイックスタート](https://auth0.com/docs/quickstart/native/react-native-expo/interactive)を参照してください。

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Auth0 のサービスを利用するには、Auth0 Dashboard でアプリケーションを設定しておく必要があります。Auth0 アプリケーションは、
      プロジェクトにおける認証の設定を行う場所です。

      ### アプリケーションを構成する

      インタラクティブセレクターを使用して新しい Auth0 アプリケーションを作成するか、統合したいプロジェクトを表す既存のアプリケーションを選択します。
      Auth0 内の各アプリケーションには、アプリケーションのコードがソフトウェア開発キット (SDK) を通じて Auth0 API を呼び出す際に使用する、
      英数字で構成された一意のクライアントIDが割り当てられます。

      このクイックスタートで構成した設定はすべて、自動的に [Dashboard](https://manage.auth0.com/#/) 上のあなたの Application に反映されます。
      今後はここから Application を管理できます。

      完全な構成を確認するには、Dashboard 内のサンプルアプリケーションを参照してください。

      ### コールバック URL とログアウト URL を構成する

      Auth0 は、ユーザーをアプリケーションにリダイレクトするために、コールバック URL とログアウト URL を呼び出します。Auth0 は、
      ユーザーを認証した後にコールバック URL を呼び出し、セッションクッキーを削除した後にログアウト URL を呼び出します。
      コールバック URL とログアウト URL を設定しない場合、ユーザーはアプリにログインおよびログアウトできなくなり、
      アプリケーションでエラーが発生します。

      アプリのプラットフォームに応じて、対応する URL を **Callback URLs** および **Logout URLs** に追加します。
      カスタムドメインを使用している場合は、Auth0 テナントのドメインの代わりに、
      カスタムドメインの値を使用してください。

      #### iOS

      ```
      BUNDLE_IDENTIFIER.auth0://{yourDomain}/ios/BUNDLE_IDENTIFIER/callback
      ```

      #### Android

      ```
      PACKAGE_NAME.auth0://{yourDomain}/android/PACKAGE_NAME/callback
      ```

      <Info>
        サンプルプロジェクトに沿って進めている場合は、次の値を設定してください。

        * **iOS**:
          `com.auth0samples.auth0://labs-fundtraining.us.auth0.com/ios/com.auth0samples/callback`
        * **Android**:
          `com.auth0samples.auth0://labs-fundtraining.us.auth0.com/android/com.auth0samples/callback`
      </Info>

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      このセクションでは、React Native Auth0 モジュールをインストールします。

      <Info>
        React Native の詳細については、[公式ドキュメント](https://facebook.github.io/react-native/) を参照してください。
      </Info>

      ### Yarn

      ```
      yarn add react-native-auth0
      ```

      <Info>
        yarn について詳しくは、[公式ドキュメント](https://yarnpkg.com/en/docs) を参照してください。
      </Info>

      ### npm

      ```
      npm install react-native-auth0 --save
      ```

      ### 追加の iOS 手順: Pod モジュールをインストールする

      ソフトウェア開発キット (SDK) の最小 iOS デプロイターゲットは 13.0 です。プロジェクトの `ios/Podfile`` で、プラットフォームターゲットが 13.0 に設定されていることを確認してください。

      ```
      platform :ios '13.0'
      ```

      CocoaPods は、React Native フレームワークがプロジェクトに組み込まれる際に使用する iOS 向けパッケージ管理ツールです。
      iOS ネイティブモジュールを iOS アプリで動作させるには、まずライブラリ用の Pod をインストールします。古い React Native ソフトウェア開発キット (SDK) のバージョンに慣れている場合は、以前のネイティブモジュールをリンクする手順に似ています。現在はプロセスが簡略化されています：

      `ios` フォルダーにディレクトリを移動して、`pod install` を実行します。

      ```
      cd ios
      pod install
      ```

      <LoggedInForm />
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      まず、ユーザーがログインできる方法を用意する必要があります。Auth0 がホストするログインページを使用することを推奨します。

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/3ZRDXpjlUXEcQpXq6Q00L1/789d583affd1f09621dc59ae49b4060c/login-ios.png" />
      </Frame>

      ### Android の設定

      アプリケーションディレクトリ内の `build.gradle` ファイル（通常は `android/app/build.gradle`）を開き、次の manifest プレースホルダーを追加します。`auth0Domain` の値には、上で設定した Auth0 のアプリケーション設定に対応する Auth0 のドメインを指定します。

      ```groovy lines
      android {
        defaultConfig {

            // 次の行を追加します

            manifestPlaceholders = [auth0Domain: &quot;{yourDomain}&quot;, auth0Scheme: &quot;${applicationId}.auth0&quot;]

        }

        ...

      } 
      ```

      <Info>
        実行時には、`applicationId` の値はアプリケーションのパッケージ名または ID（例: `com.example.app`）に自動的に更新されます。この値は
        `build.gradle` ファイルで変更できます。また、`AndroidManifest.xml` ファイルの先頭でも確認できます。
      </Info>

      ### iOS の設定

      #### AppDelegate のセットアップ（アーキテクチャに応じて選択）

      （Swift - `ios/<YOUR PROJECT>/AppDelegat.swift`）を使用している場合は、`AppDelegate` クラス内に以下を追加します。

      ```text lines
      func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey : Any] = [:]) -> Bool {
        return RCTLinkingManager.application(app, open: url, options: options)
      }
      ```

      (Objective-C++ - `ios/&lt;YOUR PROJECT&gt;/AppDelegate.mm`) を使用している場合は、以下を追加します。

      ```text lines
      #import <React/RCTLinkingManager.h>


      (BOOL)application:(UIApplication *)app openURL:(NSURL *)url
            options:(NSDictionary&lt;UIApplicationOpenURLOptionsKey, id&gt; *)options



      {
      return [RCTLinkingManager application:app openURL:url options:options];
      }
      ```

      <Info>
        [旧アーキテクチャ](https://reactnative.dev/docs/next/new-architecture-app-intro#ios---use-objective-c-mm-extension)を使用するアプリケーションでは、このファイルは `ios/&lt;YOUR PROJECT&gt;/AppDelegate.m` になります。
      </Info>

      次に、アプリのバンドル識別子を使用して URL スキーム (URLScheme) を追加します。

      `ios` フォルダーで `Info.plist` を開き、`CFBundleIdentifier` の値を探します。

      ```xml lines
      <key>CFBundleIdentifier</key>
      <string>$(PRODUCT_BUNDLE_IDENTIFIER)</string>
      ```

      この値の下に URL タイプのエントリを登録し、その `CFBundleURLSchemes` の値として `CFBundleIdentifier` の値を指定します。

      ```xml lines
      <key>CFBundleURLTypes</key>
      <array>
      <dict>
      <key>CFBundleTypeRole</key>
      <string>None</string>
      <key>CFBundleURLName</key>
      <string>auth0</string>
      <key>CFBundleURLSchemes</key>
      <array>
      <string>$(PRODUCT_BUNDLE_IDENTIFIER).auth0</string>
      </array>
      </dict>
      </array>
      ```

      <Info>
        アプリケーションが React Native CLI を使用して生成された場合、`$(PRODUCT_BUNDLE_IDENTIFIER)` のデフォルト値には
        `org.reactjs.native.example.$(PRODUCT_NAME:rfc1034identifier)` が自動的に設定されます。サンプルアプリでは、
        この値は `com.auth0samples` になります。
      </Info>

      後の手順で、この値を使用して下記のコールバック URL を定義します。次の手順で Xcode を使って変更できます。

      * アプリのルートディレクトリから `ios/<YOUR PROJECT>.xcodeproj` ファイルを開くか、ターミナルで `xed ios` を実行します。
      * プロジェクトまたは対象ターゲットの Build Settings タブを開き、「Bundle
        Identifier」を含むセクションを探します。
      * 「Bundle Identifier」の値を、目的のアプリケーションのバンドル識別子に置き換えます。

      詳細については、[React Native のドキュメント](https://facebook.github.io/react-native/docs/linking) を参照してください。

      <LoggedInForm />
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      `useAuth0` フックは、状態管理を行うために React の Context を利用します。
      `Auth0Provider` コンポーネントがこのコンテキストを提供します。

      `react-native-auth0` パッケージから `useAuth0` フックと
      `Auth0Provider` コンポーネントをインポートします。

      ```jsx lines
      import {useAuth0, Auth0Provider} from 'react-native-auth0';
      ```

      SDK を正しく動作させるには、アプリケーションを `Auth0Provider` コンポーネントでラップし、次のプロパティを設定します。

      * `domain`: Auth0 テナントのドメイン。通常、Auth0 Dashboard の該当アプリケーションの Settings の Domain フィールドで確認できます。カスタムドメインを使用している場合は、そのカスタムドメインの値を設定してください。
      * `clientId`: このクイックスタートで先ほど設定した Auth0 アプリケーションの ID。Auth0 Dashboard の該当アプリケーションの Settings タブにある Client ID フィールドで確認できます。

      <Note>
        ##### チェックポイント

        ここまでで `Auth0Provider` コンポーネントの設定が完了しました。アプリケーションを実行し、次の点を確認してください。

        * SDK が正しく初期化されていること。
        * アプリケーションで Auth0 に関連するエラーが発生していないこと。
      </Note>

      <App />
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      ユーザーを認証するには、`useAuth0` フックが提供する `authorize` メソッドを呼び出します。
      このメソッドは、ユーザーを認証するために Auth0 Universal
      Login ページへリダイレクトし、その後アプリに戻します。

      ユーザーが正常にログインできたことを確認するには、フックから提供される `user` プロパティが
      `null` になっていないことを確認します。

      <Note>
        ##### チェックポイント

        クリック時に `authorize` を呼び出すボタンコンポーネントを追加してください。ログインページにリダイレクトされ、
        その後アプリケーションに戻ることを確認してください。
      </Note>

      <App2 />
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      ユーザーをログアウトさせるには、`clearSession` を呼び出して Auth0 のログアウトエンドポイントにリダイレクトします。これにより、
      認可サーバー上のセッションが削除され、ユーザーはアプリケーションからもログアウトされます。

      <Note>
        ##### チェックポイント

        `clearSession` を呼び出すボタンを追加し、Auth0 のログアウトエンドポイントにリダイレクトされてから再び戻ってくることを確認します。
        その後は、アプリケーションにログインしていない状態になっているはずです。
      </Note>

      <App3 />
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7" isSingleColumn>
      `useAuth0` フックは、認証済みユーザーに関する情報を含む `user` オブジェクトを提供します。これを使用して、
      IDトークンから認証済みユーザーのデコードされたユーザー プロファイル情報にアクセスできます。

      ユーザーが認証されていない場合、このプロパティは `null` になります。

      <Note>
        ##### チェックポイント

        ログインして、結果の `user` プロパティを確認します。`email` や `name` など、現在のユーザーのプロファイル情報を確認します。
      </Note>

      <App4 />`
    </Section>

    ## 次のステップ

    素晴らしい!ここまで進めたなら、アプリケーションでログイン、ログアウト、およびユーザープロファイル情報が実装されているはずです。

    これでクイックスタートチュートリアルは終了ですが、他にも多くの機能があります。Auth0でできることの詳細については、以下をご確認ください:

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Auth0 テナントおよびアプリケーションの設定と管理方法を学びます
    * [react-native-auth0 ソフトウェア開発キット (SDK)](https://github.com/auth0/react-native-auth0) - このチュートリアルで使用しているソフトウェア開発キット (SDK) についてさらに詳しく知る
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0 の機能を拡張できる連携機能を見つける
  </Content>
</Recipe>