---
title: Flutter アプリケーションにログインを追加する
sidebarTitle: Flutter

---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/ja-JP/recipe.jsx";
import { LoggedInForm } from "/snippets/ja-JP/Login.jsx";
import Build from "/snippets/ja-JP/quickstart/native/flutter/build.gradle.mdx";
import MainView from "/snippets/ja-JP/quickstart/native/flutter/main_view.dart.mdx";
import MainView2 from "/snippets/ja-JP/quickstart/native/flutter/main_view.dart2.mdx";
import ProfileView from "/snippets/ja-JP/quickstart/native/flutter/profile_view.dart.mdx";

import {AuthCodeGroup} from "/snippets/ja-JP/AuthCodeGroup.jsx";

export const sections = [
  { id: "configure-auth0", title: "Auth0 を設定する" },
  { id: "install-the-auth0-flutter-sdk", title: "Auth0 Flutter ソフトウェア開発キット (SDK) をインストールする" },
  { id: "configure-android", title: "Android を設定する" },
  { id: "configure-ios-macos", title: "iOS/macOS を設定する" },
  { id: "add-login-to-your-application", title: "アプリケーションにログインを追加する" },
  { id: "add-logout-to-your-application", title: "アプリケーションにログアウトを追加する" },
  { id: "show-user-profile-information", title: "ユーザーのプロファイル情報を表示する" }
]


<Recipe isSingleColumn>
  <Content>
    Auth0を使用すると、アプリに認証を迅速に追加し、ユーザープロファイル情報にアクセスできます。このガイドでは、[Auth0 Flutter SDK](https://github.com/auth0/auth0-flutter)を使用してAuth0をFlutterアプリに統合する方法を説明します。

    <Info>
      Flutter ソフトウェア開発キット (SDK) は現在、Android、iOS、macOS 向けの Flutter アプリにのみ対応しています。
    </Info>

    このクイックスタートは、[Flutter](https://flutter.dev/)アプリがすでに稼働していることを前提としています。まだの場合は、[Flutterの「はじめに」ガイド](https://docs.flutter.dev/get-started/install)を参照して、シンプルなアプリを作成してください。

    [Flutterコマンドラインツール](https://docs.flutter.dev/reference/flutter-cli)についても理解しておく必要があります。

    <Info>
      **認証は初めてですか？** [Auth0 の仕組み](https://auth0.com/docs/overview)、[シングルページアプリケーションとの統合方法](https://auth0.com/docs/architecture-scenarios/application/spa-api)、およびどの[プロトコル](https://auth0.com/docs/flows/concepts/auth-code-pkce)を使用しているかを学びましょう。
    </Info>

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Auth0 のサービスを利用するには、Auth0 Dashboard でアプリケーションを設定しておく必要があります。Auth0 アプリケーションは、
      プロジェクトで認証をどのように動作させるかを構成する場所です。

      ### Auth0 アプリケーションを構成する

      インタラクティブセレクターを使用して新しい Auth0 アプリケーションを作成するか、既存の **Native** Auth0
      アプリケーションを選択します。Auth0 の各アプリケーションには、英数字から成る一意のクライアントIDが割り当てられており、アプリケーションコードは
      このクライアントIDを使用して、SDK を通じて Auth0 API を呼び出します。

      このクイックスタートを使用して構成した設定はすべて、[Dashboard](https://manage.auth0.com/dashboard/us/auth0-dsepaid/) 上のアプリケーションに自動的に反映されます。今後はここからアプリケーションを管理できます。

      より完全な構成を確認したい場合は、代わりにサンプルアプリを参照することもできます。

      ### コールバック URL とログアウト URL を構成する

      コールバック URL とログアウト URL は、Auth0 がアプリにリダイレクトするために呼び出す URL です。Auth0 は
      ユーザーの認証後にコールバック URL を、セッション Cookie の削除後にログアウト URL を呼び出します。コールバック URL と
      ログアウト URL が設定されていない場合、ユーザーはアプリにログインおよびログアウトできず、エラーが発生します。

      プラットフォームに応じて、コールバック URL とログアウト URL を次の値に設定します。

      <Info>
        Android では、`SCHEME` プレースホルダーの値は `https` またはその他の
        カスタムスキームにできます。`https` スキームを使用するには、[Android App Links](https://auth0.com/docs/get-started/applications/enable-android-app-links-support) を有効にする必要があります。

        iOS 17.4+ および macOS 14.4+ では、Universal Links（`https` スキーム）を
        コールバック URL およびログアウト URL として使用できます。有効にすると、SDK は古い iOS / macOS バージョンでは
        カスタム URL スキーム（アプリの [bundle identifier](https://developer.apple.com/documentation/appstoreconnectapi/bundle_ids) をスキームとして使用）にフォールバックします。**この機能には Xcode 15.3 以上と有料の Apple
        Developer アカウントが必要です。**
      </Info>

      #### Android

      ```
      SCHEME://{yourDomain}/android/YOUR_PACKAGE_NAME/callback
      ```

      #### iOS

      ```
      https://{yourDomain}/ios/YOUR_BUNDLE_IDENTIFIER/callback,
      ```

      ```
      YOUR_BUNDLE_IDENTIFIER://{yourDomain}/ios/YOUR_BUNDLE_IDENTIFIER/callback
      ```

      #### macOS

      ```
      https://{yourDomain}/macos/YOUR_BUNDLE_IDENTIFIER/callback,
      ```

      ```
      YOUR_BUNDLE_IDENTIFIER://{yourDomain}/macos/YOUR_BUNDLE_IDENTIFIER/callback
      ```

      たとえば、iOS のバンドル識別子が `com.example.MyApp`、Auth0 のドメインが
      `example.us.auth0.com` の場合、この値は次のようになります。

      ```
      https://example.us.auth0.com/ios/com.example.MyApp/callback,
      ```

      ```
      com.example.MyApp://example.us.auth0.com/ios/com.example.MyApp/callback
      ```

      <LoggedInForm />
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      Auth0 Flutter ソフトウェア開発キット (SDK) をプロジェクトに追加します。

      ```
      flutter pub add auth0_flutter
      ```

      <LoggedInForm />
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Android プラットフォーム向けに開発していない場合は、この手順をスキップしてください。

      このソフトウェア開発キット (SDK) では、マニフェストプレースホルダーが必要です。Auth0 は内部でプレースホルダーを使用して、
      認証コールバック URL を受け取るための `intent-filter` を定義します。Auth0 テナントのドメインと
      コールバック URL のスキームを設定する必要があります。

      [サンプル](https://github.com/auth0-samples/auth0-flutter-samples/tree/main/sample/android)では、次のプレースホルダーを使用します。

      * `auth0Domain`: Auth0 テナントのドメイン。通常、Auth0 Dashboard の **Application Settings** の **Domain** フィールドにあります。カスタムドメインを使用している場合は、
        代わりにそのカスタムドメインの値を設定する必要があります。
      * `auth0Scheme`: 使用するスキームです。カスタムスキーム、または [Android App Links](https://auth0.com/docs/applications/enable-android-app-links) を使用したい場合は https を指定できます。
        この値の設定方法の詳細は、[Auth0.Android SDK README](https://github.com/auth0/Auth0.Android#a-note-about-app-deep-linking) を参照してください。

      <Info>
        Auth0 の **Domain** と **Scheme** の値でマニフェストプレースホルダーを定義しているため、アクティビティ用に特定の `intent-filter` を宣言する必要はありません。
        ライブラリがリダイレクト処理を行います。
      </Info>

      変更を適用するには、Android Studio で **Sync Project with Gradle Files** を実行します。

      <LoggedInForm />
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      iOS または macOS プラットフォーム向けに開発していない場合は、この手順はスキップしてかまいません。

      <Warning>
        この手順には有料の Apple Developer アカウントが必要です。Universal Links をコールバックおよび
        ログアウト URL として使用するために必要です。代わりにカスタム URL スキームを使用する場合は、この手順をスキップしてください。
      </Warning>

      ### Team ID とバンドル識別子を設定する

      Auth0 アプリケーションの [設定ページ](https://manage.auth0.com/#/applications/\{yourClientId}/settings) に移動し、ページの一番下までスクロールして **Advanced
      Settings &gt; Device Settings** を開きます。**iOS** セクションで、**Team ID** に [Apple Team ID](https://developer.apple.com/help/account/manage-your-team/locate-your-team-id/) を、**App ID** にアプリのバンドル識別子を設定します。

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/7wetuICumueyqt6dbB32ro/df8658dff11b699ac94c578ff3dd2d8a/IOS_Settings_-_English.png" />
      </Frame>

      これにより、アプリが Auth0 テナントの `apple-app-site-association` ファイルに追加されます。

      ### Associated Domain 機能を追加する

      `open ios/Runner.xcworkspace`（macOS の場合は
      `open macos/Runner.xcworkspace`）を実行して、Xcode でアプリを開きます。**Runner** ターゲット設定の **Signing and Capabilities** [タブ](https://developer.apple.com/documentation/xcode/adding-capabilities-to-your-app#Add-a-capability)に移動し、**+
      Capability** ボタンを押します。次に、**Associated Domains** を選択します。

      <Frame>
        <img src="/docs/images/cdy7uua7fh8z/3GO76kXynaieKs5CSj3UTp/1cc577b56d00bc3bad877e31b848c1ec/ios-xcode-capabilities.png" />
      </Frame>

      次に、**Associated Domains** の下に次の [エントリ](https://developer.apple.com/documentation/xcode/configuring-an-associated-domain#Define-a-service-and-its-associated-domain)を追加します。

      ```
      webcredentials:{yourDomain}
      ```

      <Info>
        関連付けられたドメインが機能するには、**iOS シミュレータ向けにビルドする場合でも**、アプリをチーム証明書で署名する必要があります。Auth0 アプリケーションの設定ページで Team ID が設定されている Apple Team を使用していることを確認してください。
      </Info>

      <LoggedInForm />
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      Universal Login は、アプリに認証を設定する最も簡単な方法です。最適なエクスペリエンスと最高レベルのセキュリティ、そして最も充実した機能を利用するために、Universal Login の使用を推奨します。

      `Auth0` クラスを使用して、Flutter アプリに Auth0 Universal Login を統合します。`webAuthentication().login()` を使用して、ユーザーを Auth0 Universal Login ページへリダイレクトします。これは `Future` を返すため、ユーザーのトークンを取得するには `await` する必要があります。

      **Android**: カスタムスキームを使用している場合は、そのスキームを login メソッドに渡し、ソフトウェア開発キット (SDK) がログインページへの遷移と復帰を正しくルーティングできるようにします。

      ```
      await auth0.webAuthentication(scheme: 'あなたのカスタムスキーム').login();
      ```

      ユーザーがログインすると、認証後にあなたのアプリにリダイレクトされます。その後、このユーザーの ID トークンとアクセストークンにアクセスできるようになります。

      <Note>
        ##### チェックポイント

        アプリに `webAuthentication().login()` を呼び出すボタンを追加して、ユーザーをアプリにログイン
        させます。認証のために Auth0 にリダイレクトされ、その後アプリに戻ってくることを確認してください。

        `login` の呼び出し結果からトークンにアクセスできることを確認してください。
      </Note>

      <AuthCodeGroup>
        <MainView />

        <Build />

        <ProfileView />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      ユーザーをログアウトさせるには、Auth0 Flutter ソフトウェア開発キット (SDK) の `webAuthentication().logout()` を呼び出して Auth0 のログアウトエンドポイントにリダイレクトし、ログインセッションをクリアします。Auth0 からのログアウトの詳細については、こちらを参照してください。

      **Android**: カスタムスキームを使用している場合は、そのスキームを logout メソッドに渡し、SDK が正しくアプリにルーティングできるようにします。

      ```
      await auth0.webAuthentication(scheme: 'YOUR CUSTOM SCHEME').logout();
      ```

      <Note>
        ##### チェックポイント

        `webAuthentication().logout()` を呼び出してユーザーをアプリからログアウトさせるボタンをアプリに追加します。
        そのボタンを選択したときに、Flutter アプリがログアウトエンドポイントにリダイレクトされ、その後戻ってくることを確認します。
        アプリにログインしていない状態になっているはずです。
      </Note>

      <AuthCodeGroup>
        <MainView2 />

        <Build />

        <ProfileView />
      </AuthCodeGroup>
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7" isSingleColumn>
      `webAuthentication().login()` を呼び出すと、ユーザープロファイルは自動的にユーザープロファイルのプロパティを取得します。ログインステップから返されるオブジェクトには、すべてのユーザープロファイルプロパティを含む `user` プロパティがあり、これは IDトークン をデコードして設定されます。

      <Note>
        ##### チェックポイント

        ログインして、結果の `user` プロパティを確認します。`email` や `name` など、現在のユーザーのプロファイル情報を検証します。
      </Note>

      <AuthCodeGroup>
        <ProfileView />

        <Build />

        <MainView />
      </AuthCodeGroup>
    </Section>

    ## 次のステップ

    素晴らしい!ここまで進めたなら、アプリケーションでログイン、ログアウト、およびユーザープロファイル情報が実装されているはずです。

    これでクイックスタートチュートリアルは終了ですが、他にも多くの機能があります。Auth0でできることの詳細については、以下をご確認ください:

    * [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Auth0 テナントとアプリケーションを設定および管理する方法を学びます
    * [auth0-flutter ソフトウェア開発キット (SDK)](https://www.github.com/auth0/auth0-flutter/) - このチュートリアルで使用するソフトウェア開発キット (SDK) についてさらに詳しく見てみましょう
    * [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0 の機能を拡張するためのインテグレーションを見つける
  </Content>
</Recipe>